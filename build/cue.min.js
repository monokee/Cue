!function(e){const t=()=>{},n=Promise.resolve();function o(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){if(e.constructor!==t.constructor)return!1;let n;if(Array.isArray(e)){if(e.length!==t.length)return!1;for(n=e.length;0!=n--;)if(!o(e[n],t[n]))return!1;return!0}const r=Object.keys(e),s=r.length;if(s!==Object.keys(t).length)return!1;for(n=s;0!=n--;)if(!Object.prototype.hasOwnProperty.call(t,r[n]))return!1;for(n=s;0!=n--;){const s=r[n];if(!o(e[s],t[s]))return!1}return!0}return e!=e&&t!=t}function r(e){if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){const t=[];for(let n=0;n<e.length;n++)t.push(r(e[n]));return t}const t=Object.keys(e),n={};for(let o,s=0;s<t.length;s++)o=t[s],n[o]=r(e[o]);return n}function s(e){if(!e.length)return 0;let t=0;for(let n,o=0;o<e.length;o++)n=e.charCodeAt(o),t=(t<<5)-t+n,t&=t;return t}const i=e.localStorage,a=new Map,c="CUE_SERVER_CACHE::KEYS",l=Symbol(),u={fetch:(e,t=0,n)=>new Promise((o,r)=>{const a=s(e),u=function(e){const t=i.getItem(e+"::ts");return null===t?l:Number(t)<Date.now()?(h(e),l):JSON.parse(i.getItem(e))}(a);u===l?d(e,"GET",n).then(e=>{t>0&&function(e,t,n){const o=Date.now()+1e3*n;"object"==typeof t&&(t=JSON.stringify(t));const r=e+"::ts";i.setItem(e,t),i.setItem(r,""+o);let s=i.getItem(c);null===s?s=`${e},${r},`:-1===s.indexOf(e+",")&&(s=`${s}${e},${r},`);i.setItem(c,s)}(a,e,t),o(e)}).catch(e=>{r(e)}):o(u)}),get(e,t=0,n){return this.fetch(e,t,n)},post:(e,t,n)=>new Promise((o,r)=>{d(e,"POST",n,t).then(e=>o(e)).catch(e=>r(e))}),put:(e,t,n)=>new Promise((o,r)=>{d(e,"PUT",n,t).then(e=>o(e)).catch(e=>r(e))}),delete:(e,t,n)=>new Promise((o,r)=>{d(e,"DELETE",n,t).then(e=>o(e)).catch(e=>r(e))}),clearCache(e){h(s(e))}};function h(e){if(e){if(null!==i.getItem(e)){const t=e+"::ts";i.removeItem(e),i.removeItem(t);const n=i.getItem(c);if(null!==n){const o=n.split(",");o.splice(o.indexOf(e),1),o.splice(o.indexOf(t),1),i.setItem(c,o.join(",")+",")}}}else{const e=i.getItem(c);if(null!==e){const t=e.split(",");for(let e=0;e<t.length;e++)i.removeItem(t[e]);i.removeItem(c)}}}function d(e,t,n,o={}){if(a.has(e))return a.get(e);{const r={"Content-Type":"application/json"};return n&&(r.Authorization="Bearer "+n),a.set(e,new Promise((n,s)=>{fetch(e,{method:t,mode:"cors",cache:"no-store",credentials:"same-origin",headers:r,redirect:"follow",referrer:"no-referrer",body:"GET"===t?null:"string"==typeof o?o:JSON.stringify(o)}).then(e=>{e.ok?204===e.status?n({}):e.json().then(e=>n(e)):e.json().then(e=>s(e))}).catch(e=>{s(e)}).finally(()=>{a.delete(e)})})),a.get(e)}}let f=null,p=null,g=!1;const m=new Map,b=new Map,y=new Map,v=new Map,w=[],R={cueEvent(e,t){m.set(e,t)},cueCallback(e,t){b.set(e,t)},cueComputations(e,t,n,o){const r=e.get(n),s=[e,t,o];for(let e=0;e<r.length;e++)y.set(r[e],s)},react:()=>f||(f=new Promise(C))};function C(e){!1===g&&(p=e,requestAnimationFrame(x))}function x(){let e,t,n,o,r,s,i,a;for(t of(g=!0,m.entries()))t[0](t[1]);for(;y.size>0;){for(t of y.entries())o=t[0],-1===w.indexOf(o)&&(r=t[1],i=r[0],s=r[1],o.needsUpdate=!0,a=o.value(r[2]),!0===o.hasChanged&&(s[o.ownPropertyName]&&b.set(s[o.ownPropertyName],a),v.set(o,r)),w.push(o));for(t of(y.clear(),v.entries()))if(o=t[0],r=t[1],n=r[0].get(o.ownPropertyName),n)for(e=0;e<n.length;e++)y.set(n[e],r);v.clear()}for(t of b.entries())t[0](t[1]);for(m.clear(),b.clear();w.length>0;)w.pop();g=!1,p(),p=null,f=null}const E=new Map,O=new Map,j={id:Symbol("Cue.Store"),get(e){if(!e){const e={};for(const t of E.entries())e[t[0]]=r(t[1]);return e}return r(E.get(e))},set(e,t){if(e&&"object"==typeof e){let t=!1;for(const n in e){const o=P(n,e[n],!0);t=t||o}return t?R.react():n}return P(e,t,!0)?R.react():n},has:e=>E.has(e),remove:e=>E.has(e)?(E.delete(e),S(e,void 0)):(console.warn(`Can't remove Store entry "${e}" because it doesn't exist.`),n),clear(e=!1){if(0===E.size)return n;if(!0===e)return E.clear(),n;const t=E.keys();E.clear();const o=[];for(const e of t)o.push(S(e,void 0));return Promise.all(o)},bind(e,t){const n={id:this.id,path:e};return 1===arguments.length?n:Object.assign(n,{defaultValue:t})},subscribe(e,t,n={}){const o=Object.assign({autorun:!1},n,{handler:n.scope?t.bind(n.scope):t});return O.has(e)?O.get(e).push(o):O.set(e,[o]),!0===o.autorun&&(E.has(e)?S(e,E.get(e)):console.warn(`Can not autorun Store subscription because "${e}" is not set.`)),{unsubscribe:()=>{const t=O.get(e);t.splice(t.indexOf(o),1)}}}};function P(e,t,n){return(!0!==n||!o(E.get(e),t))&&(E.set(e,t),S(e,t),!0)}function S(e,t){const o=O.get(e);if(o){for(let e=0;e<o.length;e++)R.cueEvent(o[e].handler,t);return R.react()}return n}const T={computedProperty:null,computedProperties:null};let _=null,k=[];class ${constructor(e,t,n=[]){this.ownPropertyName=e,this.computation=t,this.sourceProperties=n,this.intermediate=void 0,this._value=void 0,this._type=-1,this.needsUpdate=!0,this.hasChanged=!1}value(e){return!0===this.needsUpdate&&(this.intermediate=this.computation.call(e,e,this._value),Array.isArray(this.intermediate)?(this.hasChanged=1!==this._type||!function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(this._value,this.intermediate))&&(this._value=this.intermediate.slice(),this._type=1):"object"==typeof this.intermediate&&null!==this.intermediate?(this.hasChanged=2!==this._type||!function(e,t){const n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(let r,s=0;s<n.length;s++)if(r=n[s],-1===o.indexOf(r)||e[r]!==t[r])return!1;return!0}(this._value,this.intermediate))&&(this._value=Object.assign({},this.intermediate),this._type=2):(this.hasChanged=this._value!==this.intermediate)&&(this._value=this.intermediate,this._type=0),this.needsUpdate=!1),this._value}}function M(e,t){return function(e){_=e;const t=new Map;let n;for(n of e.keys())I(n,[],t);return _=null,k=[],t}(function(e,t){Object.assign(T,{computedProperties:t});const n=new Proxy(e,{get:N});let o;for(o of t.values()){T.computedProperty=o;try{o.computation.call(n,n)}catch(e){if(e.type&&"cue-internal"===e.type)throw new Error(e.message)}}return T.computedProperty=null,T.computedProperties=null,t}(e,t))}function N(e,t){const{computedProperty:n}=T;if(!e.hasOwnProperty(t))throw{type:"cue-internal",message:`Cannot resolve computed property "${n.ownPropertyName}" because dependency "${t}" doesn't exist.`};-1===n.sourceProperties.indexOf(t)&&n.sourceProperties.push(t)}function I(e,t,n){if(_.has(e)){t.push(e),k.push(e);const o=_.get(e);for(let e,r=0;r<o.sourceProperties.length;r++){if(e=o.sourceProperties[r],-1!==t.indexOf(e))throw new Error(`Circular dependency. "${o.ownPropertyName}" is required by "${e}": ${t.join(" -> ")}`);-1===k.indexOf(e)&&I(e,t,n)}n.has(e)||n.set(e,o)}}const A=/\$self/g,L=[" ",".",":","#","[",">","+","~"];let H=-1;const z=Symbol("Component Data"),D=document.createElement("div"),q={compiler:Object.assign(document.head.appendChild(document.createElement("style")),{id:"cue::compiler"}),components:Object.assign(document.head.appendChild(document.createElement("style")),{id:"cue::components"})},U={define(e,s){let i=!1,a=!1;const c={initialize:t,connected:t,disconnected:t},l={static:{},computed:new Map,bindings:{},reactions:{},events:{}},u=document.createElement("template");u.innerHTML=s.element||"";const h=function e(t,n){for(let o,r,s,i,a=0;a<t.children.length;a++)o=t.children[a],r=o.getAttribute("$"),r&&(s=o.getAttribute("class"),i=r+ ++H,n["$"+r]="."+i,o.setAttribute("class",s?s+" "+i:i),o.removeAttribute("$")),e(o,n);return n}(u.content,{}),d=class extends HTMLElement{constructor(){super(),this[z]={reactions:{},computedProperties:new Map,subscriptions:[],refs:{},_data:{},initialized:!1,hasDataEventListener:!1,dataEvents:{},dataEventHandlers:new Map},!1===i&&(i=!0,"string"==typeof s.styles&&s.styles.length&&function(e,t,n){t=t.replace(A,e);for(const e in n)t=t.replace(new RegExp("\\"+e,"g"),n[e]);q.compiler.innerHTML=t;const o=q.compiler.sheet;let r="",s="";for(let t,n=0;n<o.rules.length;n++)t=o.rules[n],7===t.type||8===t.type?r+=t.cssText:1===t.type?r+=B(t,e):4===t.type||12===t.type?s+=G(e,t):console.warn(`CSS Rule of type "${t.type}" is not currently supported by Cue Components.`);r+=s,q.compiler.innerHTML="",q.components.innerHTML+=r}(e,s.styles,h),"function"==typeof s.initialize&&(c.initialize=s.initialize),"function"==typeof s.connectedCallback&&(c.connected=s.connectedCallback),"function"==typeof s.disconnectedCallback&&(c.disconnected=s.disconnectedCallback))}connectedCallback(){if(!1===a){a=!0;const e={};if(s.data){s.data="function"==typeof s.data?s.data():s.data;for(const t in s.data){const n=s.data[t];e[t]=n.value,n.value&&n.value.id===j.id?l.bindings[t]=n.value:"function"==typeof n.value?l.computed.set(t,new $(t,n.value)):l.static[t]=n.value,"function"==typeof n.reaction&&(l.reactions[t]=n.reaction),!0===n.event?l.events[t]={bubbles:!0,cancelable:!0}:"object"==typeof n.event&&null!==n.event&&(l.events[t]=n.event)}}l.computed.size>0&&(l.computed=M(e,l.computed))}const t=this[z];if(!1===t.initialized){t.initialized=!0;const n=t._data=Object.assign(r(l.static),t._data),o=t.computedProperties;t.data=new Proxy(n,{set:V,get:(e,n)=>l.bindings[n]?j.get(l.bindings[n].path):o.has(n)?o.get(n).value(t.data):r(e[n])});for(const e of l.computed.entries()){const t=e[1];o.set(e[0],new $(t.ownPropertyName,t.computation,t.sourceProperties))}t.dependencyGraph=function(e){const t=new Map;let n,o,r;for(n of e.values())for(o=0;o<n.sourceProperties.length;o++)r=n.sourceProperties[o],t.has(r)?t.get(r).push(n):t.set(r,[n]);return t}(t.computedProperties);for(const e in l.reactions)t.reactions[e]=n=>{l.reactions[e](t.refs,n,t.data)};for(const e in l.events)t.dataEvents[e]=new CustomEvent("_cue:data",Object.assign(l.events[e],{detail:{key:e,value:void 0}}));0===this.innerHTML.length&&(this.innerHTML=u.innerHTML);for(const e in h){const n=this.querySelector(h[e]);n&&(n[z]||(n[z]={},n.renderEach=Q),t.refs[e]=n)}if(t.refs.$self=this,this.hasAttribute("data")){const e=JSON.parse(this.getAttribute("data"));this.removeAttribute("data"),Object.assign(t._data,e)}for(const n in l.bindings){const o=l.bindings[n],r=o.path;if(j.has(r))t.reactions[n]&&R.cueCallback(t.reactions[n],j.get(r));else{if(!o.hasOwnProperty("defaultValue"))throw new Error(`Component data of "${e}" has property "${n}" bound to Store["${r}"] but Store has no value and component specifies no default.`);j.set(r,o.defaultValue)}}for(const e in t.reactions)R.cueCallback(t.reactions[e],t.data[e]);R.react().then(()=>{c.initialize.call(this,t.refs),c.connected.call(this,t.refs)})}else c.connected.call(this,t.refs);for(const e in l.bindings)t.dependencyGraph.has(e)&&t.subscriptions.push(j.subscribe(l.bindings[e].path,()=>R.cueComputations(t.dependencyGraph,t.reactions,e,t.data),{autorun:!1})),t.reactions[e]&&t.subscriptions.push(j.subscribe(l.bindings[e].path,t.reactions[e],{autorun:!1}))}disconnectedCallback(){const e=this[z],t=e.subscriptions;for(;t.length;)t.pop().unsubscribe();c.disconnected.call(this,e.refs)}getData(e){if(!e){const e=this[z],t={};let n;for(n in l.bindings)t[n]=j.get(l.bindings[n].path);for(n in e._data)t[n]=r(e._data[n]);return t}return this[z].data[e]}setData(e,t){if("object"==typeof e&&null!==e){const t=this[z];let r=!1;for(const n in e){if(l.computed.has(n))throw new Error(`Can not set property "${n}" because it is a computed property.`);const s=e[n];o(t._data[n],s)?r=r||!1:(r=!0,l.bindings[n]?P(l.bindings[n].path,s,!1):(t._data[n]=s,t.reactions[n]&&R.cueCallback(t.reactions[n],s),t.dependencyGraph.has(n)&&R.cueComputations(t.dependencyGraph,t.reactions,n,t.data)),t.dataEvents[n]&&(t.dataEvents[n].detail.value=s,this.dispatchEvent(t.dataEvents[n])))}return r?R.react():n}if(l.computed.has(e))throw new Error(`You can not set property "${e}" because it is a computed property.`);if(l.bindings[e])return P(l.bindings[e].path,t,!0)?R.react():n;const r=this[z];return o(r._data[e],t)?n:(r._data[e]=t,r.dataEvents[e]&&(r.dataEvents[e].detail.value=t,this.dispatchEvent(r.dataEvents[e])),r.reactions[e]&&R.cueCallback(r.reactions[e],t),r.dependencyGraph.has(e)&&R.cueComputations(r.dependencyGraph,r.reactions,e,r.data),R.react())}onData(e,t){const n=this[z];!1===n.hasDataEventListener&&(n.hasDataEventListener=!0,this.addEventListener("_cue:data",e=>{const t=n.dataEventHandlers.get(e.detail.key);if(t)for(let n=0;n<t.length;n++)t[n](e.detail.value)})),n.dataEventHandlers.has(e)?n.dataEventHandlers.get(e).push(t):n.dataEventHandlers.set(e,[t])}};for(const e in s)"function"==typeof s[e]&&"initialize"!==e&&(d.prototype[e]=s[e]);d.prototype.renderEach=Q,customElements.define(e,d);const f="<"+e,p="</"+e+">";return e=>{let t,n,o=f;for(t in e)n=e[t],n=n&&"object"==typeof n?JSON.stringify(n):n,o+=` ${t}='${n}'`;return o+=">"+u.innerHTML+p,o}},create(e,t){let n;"<"===(e=e.trim())[0]?(D.innerHTML=e,n=D.children[0]):n=document.createElement(e);const o=n[z];return o&&t&&"object"==typeof t&&(console.warn("[Cue.js] - Component.create(...) [data] parameter will be deprecated in a future version. Pass data object as an attribute to the components factory function instead."),Object.assign(o._data,r(t))),n}};function G(e,t,n=""){4===t.type?n+="@media "+t.media.mediaText+" {":n+="@supports "+t.conditionText+" {";let o="";for(let r,s=0;s<t.cssRules.length;s++)r=t.cssRules[s],7===r.type||8===r.type?n+=r.cssText:1===r.type?n+=B(r,e):4===r.type||12===r.type?o+=G(e,r):console.warn(`CSS Rule of type "${r.type}" is not currently supported by Components.`);return n+=o+" }"}function B(e,t){let n="";if(e.selectorText.indexOf(",")>-1){const o=e.selectorText.split(","),r=[];for(let e,n=0;n<o.length;n++)e=o[n].trim(),0===e.lastIndexOf(":root",0)?r.push(e.replace(":root","")):J(e,t)?r.push(e):r.push(t+" "+e);n+=r.join(", ")+e.cssText.substr(e.selectorText.length)}else 0===e.selectorText.lastIndexOf(":root",0)?n+=e.cssText.replace(":root",""):J(e.selectorText,t)?n+=e.cssText:n+=t+" "+e.cssText;return n}function J(e,t){return e===t||0===e.lastIndexOf(t,0)&&L.indexOf(e.charAt(t.length))>-1}function V(e,t,n){throw new Error(`Can not change data in reactions: this.${t} = ${n} has been ignored.`)}function Q(e,n,o=t){e=Array.isArray(e)?e:Object.values(e||{});const r=this[z].childData||[];if(this[z].childData=e,0===e.length)this.innerHTML="";else if(0===r.length)for(let t=0;t<e.length;t++)this.appendChild(n(e[t],t,e));else!function(e,t,n,o,r){let s,i,a,c=0,l=0,u=!0,h=t.length-1,d=n.length-1,f=e.firstChild,p=f,g=e.lastChild,m=g;e:for(;u;){let o;for(u=!1,s=t[c],i=n[l];s===i;){if(r(f,i),c++,l++,p=f=f.nextSibling,h<c||d<l)break e;s=t[c],i=n[l]}for(s=t[h],i=n[d];s===i;){if(r(g,i),h--,d--,a=g,m=g=g.previousSibling,h<c||d<l)break e;s=t[h],i=n[d]}for(s=t[h],i=n[l];s===i;){if(u=!0,r(g,i),o=g.previousSibling,e.insertBefore(g,p),m=g=o,l++,h--,h<c||d<l)break e;s=t[h],i=n[l]}for(s=t[c],i=n[d];s===i;){if(u=!0,r(f,i),o=f.nextSibling,e.insertBefore(f,a),a=m=f,f=o,c++,d--,h<c||d<l)break e;s=t[c],i=n[d]}}if(d<l){if(c<=h){let t;for(;c<=h;)0===h?e.removeChild(g):(t=g.previousSibling,e.removeChild(g),g=t),h--}return}if(h<c){if(l<=d)for(;l<=d;)a?e.insertBefore(o(n[l],l,n),a):e.appendChild(o(n[l],l,n)),l++;return}const b=new Array(d+1-l),y=new Map;let v;for(v=l;v<=d;v++)b[v]=-1,y.set(n[v],v);let w=0,R=[];for(v=c;v<=h;v++)y.has(t[v])?(b[y.get(t[v])]=v,w++):R.push(v);if(0===w){for(e.textContent="",v=l;v<=d;v++)e.appendChild(o(n[v],v,n));return}const C=function(e,t){const n=[],o=[],r=new Array(e.length);let s,i,a,c=-1;for(s=t;s<e.length;s++){if(i=e[s],i<0)continue;let t,l=-1,u=n.length;if(u>0&&n[u-1]<=i)a=u-1;else{for(;u-l>1;)t=Math.floor((l+u)/2),n[t]>i?u=t:l=t;a=l}-1!==a&&(r[s]=o[a]),a===c?(c++,n[c]=i,o[c]=s):i<n[a+1]&&(n[a+1]=i,o[a+1]=s)}for(s=o[c];c>=0;s=r[s],c--)n[c]=s;return n}(b,l),x=[];let E=f;for(v=c;v<=h;v++)x[v]=E,E=E.nextSibling;for(v=0;v<R.length;v++)e.removeChild(x[R[v]]);let O,j=C.length-1;for(v=d;v>=l;v--)C[j]===v?(a=x[b[C[j]]],r(a,n[v]),j--):(-1===b[v]?O=o(n[v],v,n):(O=x[b[v]],r(O,n[v])),e.insertBefore(O,a),a=O)}(this,r,e,n,o)}const W=e.location.origin+e.location.pathname,Y=[W,e.location.hostname,e.location.hostname+"/",e.location.origin];"/"!==W[W.length-1]&&Y.push(W+"/"),e.location.pathname&&"/"!==e.location.pathname&&Y.push(e.location.pathname);const F=["/","#","/#","/#/",...Y],K=new Set,X=new Set,Z=new Map,ee=new Map,te={},ne={params:{},keepQuery:!0,revertible:!0,forceReload:!1},oe={then:t=>t(e.location.href)};let re=0,se=null,ie=!1,ae=null,ce=!1,le={},ue=!1,he=!1,de="",fe=null;const pe={options:{recursionWarningCount:5,recursionThrowCount:10,defer:50},hook(e,t,n=null,o=!1){const r=ve(e).hash;Z.has(r)||Z.set(r,[]);const s=Z.get(r);let i;i=!1===o?t.bind(n):e=>{t.call(n,e);const o=s.indexOf(i);s.splice(o,1)},s.push(i)},trigger(t,n={}){n=Object.assign({},ne,n);const{hash:o,query:r}=ve(t),s=Z.get(o);if(s&&s.length){const t=!r&&n.keepQuery?e.location.search:r,o=Object.assign(Re(t),n.params);for(let e=0;e<s.length;e++)s[e](o)}},subscribe(t,n){if(!n)throw new Error('Router.subscribe requires second parameter to be "options" object or "onRoute" handler function.');if("function"==typeof n){n={onRoute:n}}else if("function"!=typeof n.beforeRoute&&"function"!=typeof n.onRoute)throw new Error('Router.subscribe requires "options" object with "beforeRoute", "onRoute" or both handler functions.');if("*"===t)return void X.add(n.onRoute);const o=ve(t).hash,r="#"===o;if(K.has(o))throw new Error("root");K.add(o);const s=te[W]=te[W]||{beforeRoute:void 0,onRoute:void 0,children:{}};if(r)s.beforeRoute=n.beforeRoute,s.onRoute=n.onRoute;else{const e=o.split("/"),t=e[e.length-1];e.reduce((e,o)=>e[o]?(o===t&&(e[o].beforeRoute=n.beforeRoute,e[o].onRoute=n.onRoute),e[o].children):(e[o]={beforeRoute:o===t?n.beforeRoute:void 0,onRoute:o===t?n.onRoute:void 0,children:{}}).children,s.children)}!1!==n.autorun&&pe.navigate(e.location.href,{revertible:!1,forceReload:!0}).then(t=>{e.history.replaceState(null,document.title,t)}),!1===he&&(he=!0,e.addEventListener("popstate",()=>{pe.navigate(e.location.href,{revertible:!1,forceReload:!1}).then(t=>{e.history.replaceState(null,document.title,t)})}))},navigate:(e,t={})=>(t=Object.assign({},ne,t),pe.options.defer>0?new Promise(n=>{clearTimeout(fe),fe=setTimeout(()=>{ge(e,t).then(e=>n(e)),fe=null},pe.options.defer)}):ge(e,t))};function ge(t,n){const{abs:o,hash:r,query:s}=ve(t),i=!s&&n.keepQuery?e.location.search:s;le=Object.assign(Re(i),n.params);const a=Z.get(r);if(a)for(let e=0;e<a.length;e++)a[e](le);return o===de&&!1===n.forceReload?oe:ue?(console.warn('Router.navigate to "'+t+'" not executed because another navigation is still in progress.'),oe):(ue=!0,new Promise(t=>{var r;(r=o,new Promise(e=>{re=0,ie=!1,ae=null,se=e,ce=!1,te[W]||se(null),me(r)})).then(o=>{(function e(t,n=""){return new Promise(o=>{null===t||"/"===t.value?o(n):Promise.resolve(t.nextNode).then(r=>{n+=0===n.length||t.value===W||"#"===t.value[0]?t.value:"/"+t.value,o(e(r,n))})})})(o).then(r=>{const s=new URL(r);s.search=i;const a=s.toString();r===de&&!1===n.forceReload?(ue=!1,t(a)):function e(t,n=[]){return new Promise(o=>{null===t.nextNode&&o(n),Promise.resolve(t.nextNode).then(r=>{null!==r&&(t.onRoute&&n.push([t.onRoute,r.value]),o(e(r,n)))})})}(o).then(o=>{for(let e,t,r,s=0;s<o.length;s++)e=o[s],t=e[0],r=e[1],!0!==n.forceReload&&ee.has(t)&&ee.get(t)===r||(t(r,le),ee.set(t,r));X.forEach(e=>e(a,le)),de=r,!0===n.revertible&&e.history.pushState(null,document.title,a),ue=!1,t(a)})})})}))}function me(e){if(e===W)null!==ae?se(ae):be(te,[W]).then(e=>{ae=e,!1===ce&&(ce=!0,se(ae))});else if(0===e.lastIndexOf(W,0)){const t=e.substr(W.length);if("#"!==t[0])throw new Error('Invalid route "'+t+'". Nested routes must be hash based.');null!==ae?be(te.children,t.split("/")).then(e=>{!1===ce&&(ce=!0,se(Object.assign(ae,{nextNode:e})))}):be(te,[W,...t.split("/")]).then(e=>{ae=e,!1===ce&&(ce=!0,se(ae))})}else"#"===e[0]&&be(te[W].children,e.split("/")).then(e=>{!1===ce&&(ce=!0,se(Object.assign(ae,{nextNode:e})))})}function be(e,t,n=""){return new Promise(o=>{const r=t[0],s=e[r];if(!s||ie)o({value:t.length&&n.length?n+"/"+t.join("/"):t.length?t.join("/"):n.length?n:"/",nextNode:null});else{n+=0===n.length?r:"/"+r;const i=t.slice(1);if(s.beforeRoute){const a=function e(t,n,o=""){const r=n[0],s=t[r];if(!s)return n.length&&o.length?o+"/"+n.join("/"):n.length?n.join("/"):o.length?o:"/";if(o+=0===o.length?r:"/"+r,s.beforeRoute||s.onRoute)return o;return e(s.children,n.slice(1),o)}(s.children,i);Promise.resolve(s.beforeRoute(a,le)).then(c=>{if(c="string"==typeof c?function(e){const t=we(e,Y);return t?e.replace(t,W):e}(function(e){e.length>1&&"/"===e[0]&&(e=e.substr(1));e.length>1&&"/"===e[e.length-1]&&(e=e.slice(0,-1));return e}(c)):a,a===c)o({value:n,onRoute:s.onRoute,nextNode:be(s.children,i)});else if(r===W){if("/"!==a&&"#"!==a[0])throw new Error('Invalid Route Setup: "'+a+'" can not directly follow root url. Routes at this level must start with a #.');if("#"!==c[0])throw new Error('Invalid Route "'+c+'" returned from beforeRoute. Routes at this level must start with a #.');o({value:n,onRoute:s.onRoute,nextNode:be(s.children,c.split("/"))})}else"#"===r[0]?"/"===a?o({value:n,onRoute:s.onRoute,nextNode:be(s.children,c.split("/"))}):"/"===c||"#"===c[0]?ye(t)&&o(be(e,c.split("/"))):o({value:n,onRoute:s.onRoute,nextNode:be(s.children,c.split("/"))}):c===W||"#"===c[0]||0===c.lastIndexOf(W,0)?ye(t)&&me(c):o({value:n,onRoute:s.onRoute,nextNode:be(s.children,c.split("/"))})})}else s.onRoute?o({value:n,onRoute:s.onRoute,nextNode:be(s.children,i)}):o(be(s.children,i,n))}})}function ye(e){if(re++,re===pe.options.recursionThrowCount)throw ie=!0,new Error('Router.navigate is causing potentially infinite route rewrites at "'+e.join("/")+'". Stopped execution after '+pe.options.recursionThrowCount+" cycles...");return re===pe.options.recursionWarningCount&&console.warn("Router.navigate is causing more than "+pe.options.recursionWarningCount+" route rewrites..."),!0}function ve(e){if(F.indexOf(e)>-1)return{abs:W,hash:"#",query:""};if("?"===e[0]||"#"===e[0]){const t=new URL(e,W);return{abs:W+t.hash,hash:t.hash||"#",query:t.search}}if("?"!==(e=function(e){const t=we(e,F);return t?e.substr(t.length):e}(e))[0]&&"#"!==e[0])throw new Error('Invalid Route: "'+e+'". Non-root paths must start with ? query or # hash.');const t=new URL(e,W);return{abs:W+t.hash,hash:t.hash||"#",query:t.search}}function we(e,t){return t.filter(t=>0===e.lastIndexOf(t,0)).sort((e,t)=>t.length-e.length)[0]}function Re(e){const t={};if(e.length>1){const n=e.substring(1).replace(/\+/g," ").replace(/;/g,"&").split("&");for(let e,o,r=0;r<n.length;r++)e=n[r].split("=",2),o=decodeURIComponent(e[0]),o&&(t[o]=!(e.length>1)||decodeURIComponent(e[1]))}return t}const Ce={Component:U,Store:j,Server:u,Router:pe};"object"==typeof module&&"object"==typeof module.exports?module.exports=Ce:"function"==typeof define&&define.amd?define("Cue",[],(function(){return Ce})):e.Cue=Ce}(window||this);