(function(a){function c(d,a){if(d===a)return!0;if(d&&a&&"object"==typeof d&&"object"==typeof a){if(d.constructor!==a.constructor)return!1;let b;if(Array.isArray(d)){if(d.length!==a.length)return!1;for(b=d.length;0!=b--;)if(!c(d[b],a[b]))return!1;return!0}const e=Object.keys(d),f=e.length;if(f!==Object.keys(a).length)return!1;for(b=f;0!=b--;)if(!Object.prototype.hasOwnProperty.call(a,e[b]))return!1;for(b=f;0!=b--;){const f=e[b];if(!c(d[f],a[f]))return!1}return!0}return d!==d&&a!==a}function d(a){if(!a||"object"!=typeof a)return a;if(Array.isArray(a)){const b=[];for(let c=0;c<a.length;c++)b.push(d(a[c]));return b}const b=Object.keys(a),c={};for(let e,f=0;f<b.length;f++)e=b[f],c[e]=d(a[e]);return c}function e(c,a){if(c.length!==a.length)return!1;for(let b=0;b<c.length;b++)if(c[b]!==a[b])return!1;return!0}function f(c,a){const b=Object.keys(c),d=Object.keys(a);if(b.length!==d.length)return!1;for(let e,f=0;f<b.length;f++)if(e=b[f],-1===d.indexOf(e)||c[e]!==a[e])return!1;return!0}function g(a){if(!a.length)return 0;let b=0;for(let c,d=0;d<a.length;d++)c=a.charCodeAt(d),b=(b<<5)-b+c,b&=b;return b}function h(a,b,c){const d=Date.now();"object"==typeof b&&(b=JSON.stringify(b));const e=`${a}::ts`;V.setItem(a,b),V.setItem(e,`${d+1e3*c}`);let f=V.getItem(X);null===f?f=`${a},${e},`:-1===f.indexOf(`${a},`)&&(f=`${f}${a},${e},`),V.setItem(X,f)}function i(a){const b=V.getItem(`${a}::ts`);return null===b?Y:+b<Date.now()?(j(a),Y):JSON.parse(V.getItem(a))}function j(a){if(!a){const a=V.getItem(X);if(null!==a){const b=a.split(",");for(let a=0;a<b.length;a++)V.removeItem(b[a]);V.removeItem(X)}}else if(null!==V.getItem(a)){const b=`${a}::ts`;V.removeItem(a),V.removeItem(b);const c=V.getItem(X);if(null!==c){const d=c.split(",");d.splice(d.indexOf(a),1),d.splice(d.indexOf(b),1),V.setItem(X,`${d.join(",")},`)}}}function k(a,b,c,d={}){if(W.has(a))return W.get(a);else{const e={"Content-Type":"application/json"};return c&&(e.Authorization=`Bearer ${c}`),W.set(a,new Promise((c,f)=>{fetch(a,{method:b,mode:"cors",cache:"no-store",credentials:"same-origin",headers:e,redirect:"follow",referrer:"no-referrer",body:"GET"===b?null:"string"==typeof d?d:JSON.stringify(d)}).then(a=>{a.ok?204===a.status?c({}):a.json().then(a=>c(a)):a.json().then(a=>f(a))}).catch(a=>{f(a)}).finally(()=>{W.delete(a)})})),W.get(a)}}function l(a){!1===aa&&(_=a,requestAnimationFrame(m))}function m(){aa=!0;let a,b,c,d,e,f,g,h;for(b of ba.entries())b[0](b[1]);for(;0<da.size;){for(b of da.entries())d=b[0],-1===fa.indexOf(d)&&(e=b[1],g=e[0],f=e[1],d.needsUpdate=!0,h=d.value(e[2]),!0===d.hasChanged&&(f[d.ownPropertyName]&&ca.set(f[d.ownPropertyName],h),ea.set(d,e)),fa.push(d));da.clear();for(b of ea.entries())if(d=b[0],e=b[1],c=e[0].get(d.ownPropertyName),c)for(a=0;a<c.length;a++)da.set(c[a],e);ea.clear()}for(b of ca.entries())b[0](b[1]);for(ba.clear(),ca.clear();0<fa.length;)fa.pop();aa=!1,_(),_=null,$=null}function n(a,b){if(null!==a&&"object"==typeof a){let c,d;for(let e=1;e<b.length;e++)d=b[e],c=1==e?a:c[b[e-1]];if(c.hasOwnProperty(d))return[c,d];throw new Error(`Can not access store path: "${b.join("/")}". Property ".../${d}" does not exist.`)}else throw new Error(`Can not access store path: "${b.join("/")}". The value stored at: "${b[0]}" is not object or array.`)}function o(a,b){const c=ia.get(a);if(c){for(let a=0;a<c.length;a++)ga.cueEvent(c[a].handler,b);return ga.react()}return U}function p(a,b,c,d){const e=ia.get(a);if(e){let a,f,g,h,i=!1;for(a=0;a<e.length;a++)if(!0===e[a].bubbles){i=!0;break}if(!0==i){const b=[];let e=c[0],i=d,j=ia.get(e);if(j)for(a=0;a<j.length;a++)b.push([j[a],d]);for(a=1;a<c.length;a++)if(e+="/"+c[a],i=i[c[a]],j=ia.get(e),j)for(f=0;f<j.length;f++)b.push([j[f],i]);for(a=b.length-1;0<=a;a--)g=b[a],h=g[0],ga.cueEvent(g[0].handler,g[1])}else for(a=0;a<e.length;a++)ga.cueEvent(e[a].handler,b);return ga.react()}return U}function q(a,b){return t(s(a,b))}function r(a){const b=new Map;let c,d,e;for(c of a.values())for(d=0;d<c.sourceProperties.length;d++)e=c.sourceProperties[d],b.has(e)?b.get(e).push(c):b.set(e,[c]);return b}function s(a,b){Object.assign(ma,{computedProperties:b});const c=new Proxy(a,{get:u});let d;for(d of b.values()){ma.computedProperty=d;try{d.computation.call(c,c)}catch(a){if(a.type&&"cue-internal"===a.type)throw new Error(a.message)}}return ma.computedProperty=null,ma.computedProperties=null,b}function t(a){na=a;const b=new Map;let c;for(c of a.keys())v(c,[],b);return na=null,oa=[],b}function u(a,b){const{computedProperty:c}=ma;if(!a.hasOwnProperty(b))throw{type:"cue-internal",message:`Cannot resolve computed property "${c.ownPropertyName}" because dependency "${b}" doesn't exist.`};-1===c.sourceProperties.indexOf(b)&&c.sourceProperties.push(b)}function v(a,b,c){if(na.has(a)){b.push(a),oa.push(a);const d=na.get(a);for(let a,e=0;e<d.sourceProperties.length;e++){if(a=d.sourceProperties[e],-1!==b.indexOf(a))throw new Error(`Circular dependency. "${d.ownPropertyName}" is required by "${a}": ${b.join(" -> ")}`);-1===oa.indexOf(a)&&v(a,b,c)}c.has(a)||c.set(a,d)}}function w(a,b){for(let c,d,e,f=0;f<a.children.length;f++)c=a.children[f],d=c.getAttribute(qa),d&&(e=d+ ++ta,b[qa+d]="."+e,c.className+=c.className?" "+e:e,c.removeAttribute(qa)),w(c,b);return b}function x(a,b,c){for(const d in b=b.replace(ra,a),c)b=b.replace(new RegExp("\\"+d,"g"),c[d]);wa.compiler.innerHTML=b;const d=wa.compiler.sheet;let e="",f="";for(let g,h=0;h<d.rules.length;h++)g=d.rules[h],7===g.type||8===g.type?e+=g.cssText:1===g.type?e+=z(g,a):4===g.type||12===g.type?f+=y(a,g):console.warn(`CSS Rule of type "${g.type}" is not currently supported by Cue Components.`);e+=f,wa.compiler.innerHTML="",wa.components.innerHTML+=e}function y(a,b,c=""){c+=4===b.type?"@media "+b.media.mediaText+" {":"@supports "+b.conditionText+" {";let d="";for(let e,f=0;f<b.cssRules.length;f++)e=b.cssRules[f],7===e.type||8===e.type?c+=e.cssText:1===e.type?c+=z(e,a):4===e.type||12===e.type?d+=y(a,e):console.warn(`CSS Rule of type "${e.type}" is not currently supported by Components.`);return c+=d+" }",c}function z(a,b){let c="";if(-1<a.selectorText.indexOf(",")){const d=a.selectorText.split(","),e=[];for(let a,c=0;c<d.length;c++)a=d[c].trim(),0===a.lastIndexOf(":root",0)?e.push(a.replace(":root","")):A(a,b)?e.push(a):e.push(b+" "+a);c+=e.join(", ")+a.cssText.substr(a.selectorText.length)}else c+=0===a.selectorText.lastIndexOf(":root",0)?a.cssText.replace(":root",""):A(a.selectorText,b)?a.cssText:b+" "+a.cssText;return c}function A(a,b){return!(a!==b)||0===a.lastIndexOf(b,0)&&-1<sa.indexOf(a.charAt(b.length))}function B(a,b,c){throw new Error(`Can not change data in reactions: this.${b} = ${c} has been ignored.`)}function C(a,b,c=T){a=Array.isArray(a)?a:Object.values(a||{});const d=this[ua].childData||[];if(this[ua].childData=a,0===a.length)this.innerHTML="";else if(0===d.length)for(let c=0;c<a.length;c++)this.appendChild(b(a[c],c,a));else D(this,d,a,b,c)}function D(c,d,e,f,g){let h,j,k,l=0,m=0,n=!0,o=d.length-1,p=e.length-1,q=c.firstChild,r=q,s=c.lastChild,t=s;outer:for(;n;){n=!1;let a;for(h=d[l],j=e[m];h===j;){if(g(q,j),l++,m++,r=q=q.nextSibling,o<l||p<m)break outer;h=d[l],j=e[m]}for(h=d[o],j=e[p];h===j;){if(g(s,j),o--,p--,k=s,t=s=s.previousSibling,o<l||p<m)break outer;h=d[o],j=e[p]}for(h=d[o],j=e[m];h===j;){if(n=!0,g(s,j),a=s.previousSibling,c.insertBefore(s,r),t=s=a,m++,o--,o<l||p<m)break outer;h=d[o],j=e[m]}for(h=d[l],j=e[p];h===j;){if(n=!0,g(q,j),a=q.nextSibling,c.insertBefore(q,k),k=t=q,q=a,l++,p--,o<l||p<m)break outer;h=d[l],j=e[p]}}if(p<m){if(l<=o)for(let a;l<=o;)0===o?c.removeChild(s):(a=s.previousSibling,c.removeChild(s),s=a),o--;return}if(o<l){if(m<=p)for(;m<=p;)k?c.insertBefore(f(e[m],m,e),k):c.appendChild(f(e[m],m,e)),m++;return}const u=Array(p+1-m),v=new Map;let w;for(w=m;w<=p;w++)u[w]=-1,v.set(e[w],w);let x=0,y=[];for(w=l;w<=o;w++)v.has(d[w])?(u[v.get(d[w])]=w,x++):y.push(w);if(0==x){for(c.textContent="",w=m;w<=p;w++)c.appendChild(f(e[w],w,e));return}const z=E(u,m),A=[];let B=q;for(w=l;w<=o;w++)A[w]=B,B=B.nextSibling;for(w=0;w<y.length;w++)c.removeChild(A[y[w]]);let C,D=z.length-1;for(w=p;w>=m;w--)z[D]===w?(k=A[u[z[D]]],g(k,e[w]),D--):(-1===u[w]?C=f(e[w],w,e):(C=A[u[w]],g(C,e[w])),c.insertBefore(C,k),k=C)}function E(a,b){var c=Math.floor;const d=[],e=[],f=Array(a.length);let g,h,k,m=-1;for(g=b;g<a.length;g++){if(h=a[g],0>h)continue;let b,i=-1,j=d.length;if(0<j&&d[j-1]<=h)k=j-1;else{for(;1<j-i;)b=c((i+j)/2),d[b]>h?j=b:i=b;k=i}-1!==k&&(f[g]=e[k]),k===m?(m++,d[m]=h,e[m]=g):h<d[k+1]&&(d[k+1]=h,e[k+1]=g)}for(g=e[m];0<=m;g=f[g],m--)d[m]=g;return d}function F(b,c){const{abs:d,hash:e,query:f}=N(b),g=!f&&c.keepQuery?a.location.search:f;Ma=Object.assign(S(g),c.params);const h=Ca.get(e);if(h)for(let a=0;a<h.length;a++)h[a](Ma);return d===Pa&&!1===c.forceReload?Ga:Na?(console.warn("Router.navigate to \""+b+"\" not executed because another navigation is still in progress."),Ga):(Na=!0,new Promise(b=>{G(d).then(d=>{L(d).then(e=>{const f=new URL(e);f.search=g;const h=f.toString();e===Pa&&!1===c.forceReload?(Na=!1,b(h)):K(d).then(d=>{for(let a,b,e,f=0;f<d.length;f++)a=d[f],b=a[0],e=a[1],!0!==c.forceReload&&Da.has(b)&&Da.get(b)===e||(b(e,Ma),Da.set(b,e));Pa=e,!0===c.revertible&&a.history.pushState(null,document.title,h),Na=!1,b(h)})})})}))}function G(a){return new Promise(b=>{Ha=0,Ja=!1,Ka=null,Ia=b,La=!1,Ea[ya]||Ia(null),H(a)})}function H(a){if(a===ya)null===Ka?I(Ea,[ya]).then(a=>{Ka=a,!1===La&&(La=!0,Ia(Ka))}):Ia(Ka);else if(0===a.lastIndexOf(ya,0)){const b=a.substr(ya.length);if("#"!==b[0])throw new Error("Invalid route \""+b+"\". Nested routes must be hash based.");null===Ka?I(Ea,[ya,...b.split("/")]).then(a=>{Ka=a,!1===La&&(La=!0,Ia(Ka))}):I(Ea.children,b.split("/")).then(a=>{!1===La&&(La=!0,Ia(Object.assign(Ka,{nextNode:a})))})}else"#"===a[0]&&I(Ea[ya].children,a.split("/")).then(a=>{!1===La&&(La=!0,Ia(Object.assign(Ka,{nextNode:a})))})}function I(a,b,c=""){return new Promise(d=>{const e=b[0],f=a[e];if(!f||Ja)d({value:b.length&&c.length?c+"/"+b.join("/"):b.length?b.join("/"):c.length?c:"/",nextNode:null});else{c+=0===c.length?e:"/"+e;const g=b.slice(1);if(f.beforeRoute){const h=J(f.children,g);Promise.resolve(f.beforeRoute(h,Ma)).then(i=>{if(i="string"==typeof i?Q(O(i)):h,h===i)d({value:c,onRoute:f.onRoute,nextNode:I(f.children,g)});else if(e===ya){if("/"!==h&&"#"!==h[0])throw new Error("Invalid Route Setup: \""+h+"\" can not directly follow root url. Routes at this level must start with a #.");if("#"!==i[0])throw new Error("Invalid Route \""+i+"\" returned from beforeRoute. Routes at this level must start with a #.");d({value:c,onRoute:f.onRoute,nextNode:I(f.children,i.split("/"))})}else"#"===e[0]?"/"===h?d({value:c,onRoute:f.onRoute,nextNode:I(f.children,i.split("/"))}):"/"===i||"#"===i[0]?M(b)&&d(I(a,i.split("/"))):d({value:c,onRoute:f.onRoute,nextNode:I(f.children,i.split("/"))}):i===ya||"#"===i[0]||0===i.lastIndexOf(ya,0)?M(b)&&H(i):d({value:c,onRoute:f.onRoute,nextNode:I(f.children,i.split("/"))})})}else f.onRoute?d({value:c,onRoute:f.onRoute,nextNode:I(f.children,g)}):d(I(f.children,g,c))}})}function J(a,b,c=""){const d=b[0],e=a[d];return e?(c+=0===c.length?d:"/"+d,e.beforeRoute||e.onRoute?c:J(e.children,b.slice(1),c)):b.length&&c.length?c+"/"+b.join("/"):b.length?b.join("/"):c.length?c:"/"}function K(a,b=[]){return new Promise(c=>{null===a.nextNode&&c(b),Promise.resolve(a.nextNode).then(d=>{null!==d&&(a.onRoute&&b.push([a.onRoute,d.value]),c(K(d,b)))})})}function L(a,b=""){return new Promise(c=>{null===a||"/"===a.value?c(b):Promise.resolve(a.nextNode).then(d=>{b+=0===b.length||a.value===ya||"#"===a.value[0]?a.value:"/"+a.value,c(L(d,b))})})}function M(a){if(Ha++,Ha===Ra.options.recursionThrowCount)throw Ja=!0,new Error("Router.navigate is causing potentially infinite route rewrites at \""+a.join("/")+"\". Stopped execution after "+Ra.options.recursionThrowCount+" cycles...");else return Ha===Ra.options.recursionWarningCount&&console.warn("Router.navigate is causing more than "+Ra.options.recursionWarningCount+" route rewrites..."),!0}function N(a){if(-1<Aa.indexOf(a))return{abs:ya,hash:"#",query:""};if("?"===a[0]||"#"===a[0]){const b=new URL(a,ya);return{abs:ya+b.hash,hash:b.hash||"#",query:b.search}}if(a=P(a),"?"!==a[0]&&"#"!==a[0])throw new Error("Invalid Route: \""+a+"\". Non-root paths must start with ? query or # hash.");const b=new URL(a,ya);return{abs:ya+b.hash,hash:b.hash||"#",query:b.search}}function O(a){return 1<a.length&&"/"===a[0]&&(a=a.substr(1)),1<a.length&&"/"===a[a.length-1]&&(a=a.slice(0,-1)),a}function P(a){const b=R(a,Aa);return b?a.substr(b.length):a}function Q(a){const b=R(a,za);return b?a.replace(b,ya):a}function R(a,b){return b.filter(b=>0===a.lastIndexOf(b,0)).sort((c,a)=>a.length-c.length)[0]}function S(a){const b={};if(1<a.length){const c=a.substring(1).replace(/\+/g," ").replace(/;/g,"&").split("&");for(let a,d,e=0;e<c.length;e++)a=c[e].split("=",2),d=decodeURIComponent(a[0]),d&&(b[d]=!(1<a.length)||decodeURIComponent(a[1]))}return b}const T=()=>{},U=Promise.resolve(),V=a.localStorage,W=new Map,X="CUE_SERVER_CACHE::KEYS",Y=Symbol(),Z={fetch(a,b=0,c){return new Promise((d,e)=>{const f=g(a),j=i(f);j===Y?k(a,"GET",c).then(a=>{0<b&&h(f,a,b),d(a)}).catch(a=>{e(a)}):d(j)})},get(a,b=0,c){return this.fetch(a,b,c)},post(a,b,c){return new Promise((d,e)=>{k(a,"POST",c,b).then(a=>d(a)).catch(a=>e(a))})},put(a,b,c){return new Promise((d,e)=>{k(a,"PUT",c,b).then(a=>d(a)).catch(a=>e(a))})},delete(a,b,c){return new Promise((d,e)=>{k(a,"DELETE",c,b).then(a=>d(a)).catch(a=>e(a))})},clearCache(a){j(g(a))}};let $=null,_=null,aa=!1;const ba=new Map,ca=new Map,da=new Map,ea=new Map,fa=[],ga={cueEvent(a,b){ba.set(a,b)},cueCallback(a,b){ca.set(a,b)},cueComputations(a,b,c,d){const e=a.get(c),f=[a,b,d];for(let g=0;g<e.length;g++)da.set(e[g],f)},react(){return $||($=new Promise(l))}},ha=new Map,ia=new Map,ja=Object.defineProperty({get(a){if(!a){const a={};for(const b of ha.entries())a[b[0]]=d(b[1]);return a}const b=a.split("/"),c=ha.get(b[0]);if(void 0!==c){if(1<b.length){const[a,e]=n(c,b);return d(a[e])}return d(c)}},set(a,b){if(a&&"object"==typeof a){let b=!1;for(const d in a){const e=d.split("/"),f=ha.get(e[0]),g=a[d];if(1<e.length){const[a,h]=n(f,e);c(a[h],g)||(b=!0,a[h]=g,p(d,g,e,f))}else void 0!==f&&c(f,g)||(b=!0,ha.set(d,g),o(d,g))}return b?ga.react():U}const d=a.split("/"),e=ha.get(d[0]);if(1<d.length){const[f,g]=n(e,d);return c(f[g],b)?U:(f[g]=b,p(a,b,d,e))}return void 0!==e&&c(e,b)?U:(ha.set(a,b),o(a,b))},has(a){const b=a.split("/"),c=ha.get(b[0]);if(ha.has(b[0])){if(1<b.length)try{return n(c,b),!0}catch(a){return!1}return!0}return!1},remove(a){const b=a.split("/"),c=ha.get(b[0]);if(void 0===c)return console.warn(`Can't remove Store entry "${a}" because it doesn't exist.`),U;if(1<b.length){const[d,e]=n(c,b);return Array.isArray(d)?d.splice(parseInt(e),1):delete d[e],p(a,void 0,b,c)}return ha.delete(b[0]),o(a,void 0)},clear(a={silently:!1}){if(0===ha.size)return U;if(!0===a.silently)return ha.clear(),U;const b=ha.keys();ha.clear();const c=[];for(const d of b)c.push(o(d,void 0));return Promise.all(c)},bind(a,b){const c={id:this.id,path:a};return 1===arguments.length?c:Object.assign(c,{defaultValue:b})},subscribe(a,b,c={}){if("string"!=typeof a||"function"!=typeof b||null===c||"object"!=typeof c)throw new Error(`Invalid arguments. Expect (path:String, handler:Function, [options:Object]`);const d=Object.assign({bubbles:!1,autorun:!0},c,{handler:c.scope?b.bind(c.scope):b});if(ia.has(a)?ia.get(a).push(d):ia.set(a,[d]),!0===d.autorun){const b=a.split("/"),c=ha.get(b[0]);let e=!1;if(void 0===c)e=!0;else if(1<b.length){const[a,d]=n(c,b);void 0===a[d]&&(e=!0)}if(!0==e)console.warn(`Can not auto-run Store subscription handler because value at "${a}" is undefined. Pass {autorun: false} option to avoid this warning.`);else if(!1===d.bubbles)o(a,ha.get(a));else{const b=a.split("/");p(a,ha.get(a),b,ha.get(b[0]))}}return{unsubscribe(){const b=ia.get(a);b.splice(b.indexOf(d),1),0===b.length&&ia.delete(a)}}}},"id",{value:Symbol("Store ID")}),ka=1,la=2,ma={computedProperty:null,computedProperties:null};let na=null,oa=[];class pa{constructor(a,b,c=[]){this.ownPropertyName=a,this.computation=b,this.sourceProperties=c,this.intermediate=void 0,this._value=void 0,this._type=-1,this.needsUpdate=!0,this.hasChanged=!1}value(a){return!0===this.needsUpdate&&(this.intermediate=this.computation.call(a,a,this._value),Array.isArray(this.intermediate)?(this.hasChanged=this._type!==ka||!e(this._value,this.intermediate))&&(this._value=this.intermediate.slice(),this._type=ka):"object"==typeof this.intermediate&&null!==this.intermediate?(this.hasChanged=this._type!==la||!f(this._value,this.intermediate))&&(this._value=Object.assign({},this.intermediate),this._type=la):(this.hasChanged=this._value!==this.intermediate)&&(this._value=this.intermediate,this._type=0),this.needsUpdate=!1),this._value}}const qa="$",ra=/\$self/g,sa=[" ",".",":","#","[",">","+","~"];let ta=-1;const ua=Symbol("Component Data"),va=document.createElement("div"),wa={compiler:Object.assign(document.head.appendChild(document.createElement("style")),{id:"cue::compiler"}),components:Object.assign(document.head.appendChild(document.createElement("style")),{id:"cue::components"})},xa={define(a,b){let e=!1,f=!1;const g={initialize:T,connected:T,disconnected:T},h={static:{},computed:new Map,bindings:{},reactions:{}},i=document.createElement("template");i.innerHTML=b.element||"";const j=w(i.content,{}),l=class extends HTMLElement{constructor(){super(),this[ua]={reactions:{},computedProperties:new Map,subscriptions:[],refs:{},_data:{},initialized:!1},!1===e&&(e=!0,"string"==typeof b.styles&&b.styles.length&&x(a,b.styles,j),"function"==typeof b.initialize&&(g.initialize=b.initialize),"function"==typeof b.connectedCallback&&(g.connected=b.connectedCallback),"function"==typeof b.disconnectedCallback&&(g.disconnected=b.disconnectedCallback))}connectedCallback(){if(!1===f){f=!0;const a={};if(b.data)for(const c in b.data="function"==typeof b.data?b.data():b.data,b.data){const d=b.data[c];a[c]=d.value,d.value&&d.value.id===ja.id?h.bindings[c]=d.value:"function"==typeof d.value?h.computed.set(c,new pa(c,d.value)):h.static[c]=d.value,"function"==typeof d.reaction&&(h.reactions[c]=d.reaction)}0<h.computed.size&&(h.computed=q(a,h.computed))}const c=this[ua];if(!1===c.initialized){c.initialized=!0;const b=c._data=Object.assign(d(h.static),c._data),e=c.computedProperties;c.data=new Proxy(b,{set:B,get(a,b){return h.bindings[b]?ja.get(h.bindings[b].path):e.has(b)?e.get(b).value(c.data):d(a[b])}});for(const a of h.computed.entries()){const b=a[1];e.set(a[0],new pa(b.ownPropertyName,b.computation,b.sourceProperties))}for(const a in c.dependencyGraph=r(c.computedProperties),h.reactions)c.reactions[a]=h.reactions[a].bind(c.data,c.refs);for(const a in 0===this.innerHTML.length&&(this.innerHTML=i.innerHTML),j){const b=this.querySelector(j[a]);b[ua]||(b[ua]={},b.renderEach=C),c.refs[a]=b}for(const b in c.refs.$self=this,h.bindings){const d=h.bindings[b],e=d.path;if(ja.has(e))c.reactions[b]&&ga.cueCallback(c.reactions[b],ja.get(e));else if(d.hasOwnProperty("defaultValue"))ja.set(e,d.defaultValue);else throw new Error(`Component data of "${a}" has property "${b}" bound to Store["${e}"] but Store has no value and component specifies no default.`)}for(const a in c.reactions)ga.cueCallback(c.reactions[a],c.data[a]);ga.react().then(()=>{g.initialize.call(this,c.refs),g.connected.call(this,c.refs)})}else g.connected.call(this,c.refs);for(const a in h.bindings)c.dependencyGraph.has(a)&&c.subscriptions.push(ja.subscribe(h.bindings[a].path,()=>ga.cueComputations(c.dependencyGraph,c.reactions,a,c.data),{autorun:!1})),c.reactions[a]&&c.subscriptions.push(ja.subscribe(h.bindings[a].path,c.reactions[a],{autorun:!1}))}disconnectedCallback(){const a=this[ua],b=a.subscriptions;for(;b.length;)b.pop().unsubscribe();g.disconnected.call(this,a.refs)}getData(a){if(!a){const b=this[ua],c={};for(var a in h.bindings)c[a]=ja.get(h.bindings[a].path);for(a in b._data)c[a]=d(b._data[a]);return c}return this[ua].data[a]}setData(a,b){if(1===arguments.length&&"object"==typeof a&&null!==a){const b=this[ua];let d=!1;for(const e in a){const f=b._data[e],g=a[e];if(h.computed.has(e))throw new Error(`You can not set property "${e}" because it is a computed property.`);else h.bindings[e]?(d=!0,ja.set(h.bindings[e].path,g)):c(f,g)||(d=!0,b._data[e]=g,b.reactions[e]&&ga.cueCallback(b.reactions[e],g),b.dependencyGraph.has(e)&&ga.cueComputations(b.dependencyGraph,b.reactions,e,b.data))}return d?ga.react():U}if(h.bindings[a])return ja.set(h.bindings[a].path,b);if(h.computed.has(a))throw new Error(`You can not set property "${a}" because it is a computed property.`);const d=this[ua],e=d._data[a];return c(e,b)?U:(d._data[a]=b,d.reactions[a]&&ga.cueCallback(d.reactions[a],b),d.dependencyGraph.has(a)&&ga.cueComputations(d.dependencyGraph,d.reactions,a,d.data),ga.react())}};for(const c in b)"function"==typeof b[c]&&"initialize"!==c&&(l.prototype[c]=b[c]);l.prototype.renderEach=C,customElements.define(a,l);return b=>{let c,d="<"+a;for(c in b)d+=" "+c+"=\""+b[c]+"\"";return d+=">"+i.innerHTML+("</"+a+">"),d}},create(a,b){a=a.trim();let c;"<"===a[0]?(va.innerHTML=a,c=va.children[0]):c=document.createElement(a);const e=c[ua];return e&&b&&"object"==typeof b&&Object.assign(e._data,d(b)),c}},ya=a.location.origin+a.location.pathname,za=[ya,a.location.hostname,a.location.hostname+"/",a.location.origin];"/"!==ya[ya.length-1]&&za.push(ya+"/"),a.location.pathname&&"/"!==a.location.pathname&&za.push(a.location.pathname);const Aa=["/","#","/#","/#/",...za],Ba=new Set,Ca=new Map,Da=new Map,Ea={},Fa={params:{},keepQuery:!0,revertible:!0,forceReload:!1},Ga={then:b=>b(a.location.href)};let Ha=0,Ia=null,Ja=!1,Ka=null,La=!1,Ma={},Na=!1,Oa=!1,Pa="",Qa=null;const Ra={options:{recursionWarningCount:5,recursionThrowCount:10,defer:50},hook(a,b,c=null,d=!1){const e=N(a).hash;Ca.has(e)||Ca.set(e,[]);const f=Ca.get(e);let g;g=!1===d?b.bind(c):a=>{b.call(c,a);const d=f.indexOf(g);f.splice(d,1)},f.push(g)},trigger(b,c={}){c=Object.assign({},Fa,c);const{hash:d,query:e}=N(b),f=Ca.get(d);if(f&&f.length){const b=!e&&c.keepQuery?a.location.search:e,d=Object.assign(S(b),c.params);for(let a=0;a<f.length;a++)f[a](d)}},subscribe(b,c){if(!c)throw new Error("Router.subscribe requires second parameter to be \"options\" object or \"onRoute\" handler function.");else if("function"==typeof c){const a=c;c={onRoute:a}}else if("function"!=typeof c.beforeRoute&&"function"!=typeof c.onRoute)throw new Error("Router.subscribe requires \"options\" object with \"beforeRoute\", \"onRoute\" or both handler functions.");const d=N(b).hash,e="#"===d;if(Ba.has(d))throw new Error("Router already has an active subscription for \""+e?"root":b+"\".");else Ba.add(d);const f=Ea[ya]=Ea[ya]||{beforeRoute:void 0,onRoute:void 0,children:{}};if(e)f.beforeRoute=c.beforeRoute,f.onRoute=c.onRoute;else{const a=d.split("/"),b=a[a.length-1];a.reduce((a,d)=>a[d]?(d===b&&(a[d].beforeRoute=c.beforeRoute,a[d].onRoute=c.onRoute),a[d].children):(a[d]={beforeRoute:d===b?c.beforeRoute:void 0,onRoute:d===b?c.onRoute:void 0,children:{}}).children,f.children)}!1!==c.autorun&&Ra.navigate(a.location.href,{revertible:!1,forceReload:!0}).then(b=>{a.history.replaceState(null,document.title,b)}),!1===Oa&&(Oa=!0,a.addEventListener("popstate",()=>{Ra.navigate(a.location.href,{revertible:!1,forceReload:!1}).then(b=>{a.history.replaceState(null,document.title,b)})}))},navigate(a,b={}){return b=Object.assign({},Fa,b),0<Ra.options.defer?new Promise(c=>{clearTimeout(Qa),Qa=setTimeout(()=>{F(a,b).then(a=>c(a)),Qa=null},Ra.options.defer)}):F(a,b)}},Sa={Component:xa,Store:ja,Server:Z,Router:Ra};"object"==typeof module&&"object"==typeof module.exports?module.exports=Sa:"function"==typeof define&&define.amd?define("Cue",[],function(){return Sa}):a.Cue=Sa})(window||this);