(function(e){var Z=Math.min,K=Math.max;function t(e,t=0,n=this.length){if(0===arguments.length||0===this.length||t===n)return this;const i=this[ee],r=i.plainState;"object"==typeof e&&null!==e&&(e=e[ee]||w(e,i.module,ke,null));for(let s,a,d=t;d<n;d++)s=r[d],s!==e&&(r[d]=e,e&&(a=e[ee])&&!1===a.mounted&&(a.instanceDidMount(r,d),L(a)));return i.propertyDidChange(),U(),this}function n(...e){if(0<e.length){const t=this[ee],n=t.plainState;for(let r,s,a=0;a<e.length;a++)r=e[a],"object"==typeof r&&null!==r?(s=r[ee]||w(r,t.module,ke,null),n.push(s.proxyState),s.instanceDidMount(n,n.length-1),L(s)):n.push(r);t.propertyDidChange(),U()}return this.length}function i(...e){if(0<e.length){const t=this[ee],n=t.plainState;for(let r,s,a=e.length;0<=--a;)r=e[a],"object"==typeof r&&null!==r?(s=r[ee]||w(r,t.module,ke,null),!1===s.mounted&&(n.unshift(s.proxyState),s.instanceDidMount(n,0),L(s))):n.unshift(r);t.propertyDidChange(),U()}return this.length}function r(e,t,...n){const r=this[ee],s=r.plainState,a=s.length,d=0>e?K(a+e,0):Z(e,a);let o,l;1===arguments.length?(o=0,l=a-d):(o=n.length,l=Z(K(t,0),a-d));const p=[];if(0<l)for(let e,t=d+l;--t>=d;)e=s[t],s.splice(t,1),p.push(e);if(0<o)for(let e,t,a,l=0;l<o;l++)e=n[l],t=d+l,"object"==typeof e&&null!==e?(a=e[ee]||w(e,r.module,ke,null),!1===a.mounted&&(s.splice(t,0,a.proxyState),a.instanceDidMount(s,t),L(a))):s.splice(t,0,e);return r.propertyDidChange(),U(),p}function s(){const e=this[ee],t=e.plainState;if(0!==t.length){const n=t[t.length-1];return delete t[t.length-1],e.propertyDidChange(),U(),n}}function a(){const e=this[ee],t=e.plainState;if(0!==t.length){const n=t[0];return t.shift(),e.propertyDidChange(),U(),n}}function d(e,t=0,n=this.length){const i=this[ee],r=i.plainState,s=r.length;let a=0>e?K(s+e,0):Z(e,s),d=0>t?K(s+t,0):Z(t,s);const o=0>n?K(s+n,0):Z(n,s);let l,p=Z(o-d,s-a);d<a&&a<d+p?(l=-1,d=d+p-1,a=a+p-1):l=1;for(let i;0<p;){if(d in r){if(i=r[d],i&&i[ee])throw new Error(`You can't create copies of Cue State Instances via Array.prototype.copyWithin.`);r[a]=r[d]}else delete r[a];d+=l,a+=l,p-=1}return i.propertyDidChange(),U(),r}function o(){const e=this[ee],t=e.plainState;return t.reverse(),e.propertyDidChange(),U(),t}function l(e){const t=this[ee],n=t.plainState;return n.sort(e),t.propertyDidChange(),U(),n}function p(e){const t={},n=ge(e);for(let r,s,a=0;a<n.length;a++)r=n[a],s=e[r],t[r]=s?he(s)?u(s):"object"==typeof s?p(s):s:s;return t}function u(e){const t=[];for(let n,r=0;r<e.length;r++)n=e[r],t[r]=n?he(n)?u(n):"object"==typeof n?p(n):n:n;return t}function _(e,t){return he(e)?!!(he(t)&&e.length===t.length)&&g(e,t):"object"==typeof e?"object"==typeof t&&(null!==e&&null!==t||e===t)&&h(e,t):e===t}function g(e,t){for(let n=0;n<e.length;n++)if(!_(e[n],t[n]))return!1;return!0}function h(e,t){const n=ge(e),r=ge(t);if(n.length!==r.length)return!1;for(let s,a=0;a<n.length;a++)if(s=n[a],-1===r.indexOf(s)||!_(e[s],t[r[a]]))return!1;return!0}function c(e,t,n){const r=e[t];if(n!==r){if(void 0===n)return void delete e[t];if(null===r||void 0===r||null===n||"object"!=typeof n)return void(e[t]=n);if(he(n)){const e=n.length,t=r.length;if(e&&t){let s,i,a,d,o,l,p;const u=Array(e),_=new Map;for(a=0,d=Z(t,e);a<d&&r[a]===n[a];a++)c(r,a,n[a]);for(d=t-1,o=e-1;0<=d&&0<=o&&r[d]===n[o];d--,o--)u[o]=r[d];for(p=Array(o+1),i=o;i>=a;i--)l=n[i],s=_.get(l),p[i]=void 0===s?-1:s,_.set(l,i);for(s=a;s<=d;s++)l=r[s],i=_.get(l),void 0!==i&&-1!==i&&(u[i]=r[s],i=p[i],_.set(l,i));for(i=a;i<e;i++)u.hasOwnProperty(i)?(r[i]!==u[i]&&(void 0===u[i]?delete r[i]:r[i]=u[i]),c(r,i,n[i])):r[i]!==n[i]&&(void 0===n[i]?delete r[i]:r[i]=n[i])}else for(let t=0;t<e;t++)c(r,t,n[t]);t>e&&(r.length=n.length)}else{const e=ge(n);for(let t,s=0;s<e.length;s++)t=e[s],c(r,t,n[t]);const t=ge(r);for(let e,s=0;s<t.length;s++)e=t[s],void 0===n[e]&&void 0!==r[e]&&delete r[e]}}}function m(e,t){for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function f(e,t){const n=ge(e),r=ge(t);if(n.length!==r.length)return!1;for(let s,a=0;a<n.length;a++)if(s=n[a],-1===r.indexOf(s)||e[s]!==t[s])return!1;return!0}function v(e=!1){const t=this[ee],n=he(t.plainState)?u(t.plainState):p(t.plainState);return e?JSON.stringify(n):n}function S(e){const t=this[ee];e.constructor===String&&(e=JSON.parse(e)),c(t.closestModuleParent.proxyState,t.branchPropertyName,e),U()}function y(e,t){de(je,{allProperties:e,computedProperties:t});const n=new Proxy(e,{get:b});let i;for(i of t.values()){je.derivative=i;try{i.computation.call(n,n)}catch(t){}}je.derivative=null,je.allProperties=null,je.computedProperties=null}function b(e,t){const{derivative:n,allProperties:i,computedProperties:r}=je;if(!i.hasOwnProperty(t))throw new Error(`Unable to resolve dependency "${t}" of computed prop "${n.ownPropertyName}".`);if(-1===n.sourceProperties.indexOf(t)&&n.sourceProperties.push(t),r.has(t)){const e=r.get(t);-1===e.subDerivatives.indexOf(n)&&e.subDerivatives.push(n),-1===n.superDerivatives.indexOf(e)&&n.superDerivatives.push(e)}}function C(e,t){t===we?(E(e),P(e)):t===Le&&x(e)}function E(e){if(e.superDerivatives.length)for(let t,n=0;n<e.superDerivatives.length;n++)t=e.superDerivatives[n],t.stopPropagation=!1,t.superDerivatives.length&&E(t)}function P(e,t=!0){if(e.stopPropagation=t,e.subDerivatives.length)for(let t,n=0;n<e.subDerivatives.length;n++)t=e.subDerivatives[n],t.observers.length&&(e.stopPropagation=!1,P(t))}function x(e,t=!1){e.stopPropagation=t;for(let n,r=0;r<e.superDerivatives.length;r++)n=e.superDerivatives[r],n.observers.length?n.stopPropagation=!0:x(n)}function T(e,t){const n=e[ee];return t===ee?n:n.internalGetters.has(t)?n.internalGetters.get(t)(n):e[t]}function O(e,t,n){const i=e[ee];if(i.internalSetters.has(t))return i.internalSetters.get(t)(i,n),!0;if(n!==i.valueCache.get(t)){if("object"==typeof n&&null!==n){const r=n[ee]||w(n,i.module,ke,null);return!1===r.mounted?(e[t]=r.proxyState,r.instanceDidMount(e,t),L(r)):console.warn(`Can't re-mount previously mounted property "${t}" to instance of "${i.module.name}". This feature is not yet available.`),i.propertyDidChange(t,r.proxyState),i.valueCache.set(t,r.proxyState),U(),!0}return e[t]=n,i.propertyDidChange(t,n),i.valueCache.set(t,n),U(),!0}}function D(e,t){if(e.hasOwnProperty(t)){const n=e[ee];return delete e[t],n.valueCache.delete(t),n.propertyDidChange.call(n,t,void 0),U(),!0}}function U(){null===qe&&!1===We&&(qe=requestAnimationFrame(N))}function N(){We=!0;let e,t,n,i;for(const r=[];0<Ue.size;){for(e of Ue.entries())t=e[0],n=e[1],-1===r.indexOf(t)&&(t.needsUpdate=!0,i=t.value(),r.push(t),!0===t.hasChanged&&(n.cueObservers.call(n,t.ownPropertyName,i),Ne.set(t,n)));Ue.clear();for(e of Ne.entries())if(t=e[0],n=e[1],n.derivativesOf.has(t.ownPropertyName)){const e=n.derivativesOf.get(t.ownPropertyName);for(let t=0;t<e.length;t++)Ue.set(e[t],n)}Ne.clear()}for(e of De.entries())e[0](e[1]);qe=null,We=!1,De.clear()}function j(e,t){const n=ve(t)?t(Ee):t;if(!fe(n))throw new TypeError(`Can't create State Module "${e.name}" because the config function does not return a plain object.`);if(!fe(n.data))throw new TypeError(`State Module requires "data" pojo containing default and optional computed properties.`);for(const i in e.imports=n.imports,e.defaults={},e.initialize=_e,e.internalGetters=new Map([["get",()=>v],["set",()=>S]]),e.internalSetters=new Map,e.derivativesToInstall=new Map,n.data){const t=n.data[i];ve(t)?(e.derivativesToInstall.set(i,{ownPropertyName:i,computation:t,sourceProperties:[],subDerivatives:[],superDerivatives:[]}),e.internalGetters.set(i,e=>e.derivedProperties.get(i).value())):e.defaults[i]=t}for(const i in y(n.data,e.derivativesToInstall),e.derivativesToInstall=Re.from(e.derivativesToInstall),n){const t=n[i];if("initialize"==i){if(ve(t))e.initialize=t;else throw new TypeError(`"initialize" is a reserved word for Cue State Modules and must be a function but is of type "${typeof t}"`);}else if("imports"==i&&me(n.imports)){for(const t in n.imports)if(!e.internalGetters.has(t))e.internalGetters.set(t,()=>n.imports[t]);else throw new Error(`Name of imported Module "${t}" clashes with another top-level data property, a builtin property ("get"/"set" are reserved) or a method name.`);}else if(ve(t))if(!e.internalGetters.has(i))e.internalGetters.set(i,()=>t);else throw new Error(`Module method name "${i}" clashes with another data property, an import, a method name or a builtin property ("get"/"set" are reserved).`)}return e}function w(e,t,n,i){const r=e[ee]=n===Me?new $e(t,n):new Fe(t,n);return r.plainState=e,r.proxyState=new Proxy(e,{get:T,set:O,deleteProperty:D}),i&&(r.initialProps=i),r}function L(e){if(he(e.plainState))for(let t,n=0;n<e.plainState.length;n++)t=e.plainState[n],"object"==typeof t&&null!==t&&(t=t[ee]||w(t,e.module,ke,null),!1===t.mounted&&(e.plainState[n]=t.proxyState,t.instanceDidMount(e.plainState,n)),L(t));else{const t=ge(e.plainState);for(let n,r,s=0;s<t.length;s++)n=t[s],r=e.plainState[n],"object"==typeof r&&null!==r&&(r=r[ee]||w(r,e.module,ke,null),!1===r.mounted&&(e.plainState[n]=r.proxyState,r.instanceDidMount(e.plainState,n)),L(r))}}function I(e,t){let n=null;const i=e=>w(p(n.defaults),n,Me,e).proxyState;return r=>(n||(n=j(e,t)),i(r))}function M(e,t,n){const i=new Map;for(const r in n||(n=`cue-${et.cssRules.length.toString(36)}`),e)B(Y(r,n,t,i),e[r]);return t.classList.add(n),i.forEach((e,n)=>{A(n,e,t)}),i}function k(e,t,n,i){return e.getElementsByTagName(n).length?`.${t} ${n}`:"#"===n[0]?n:(n=n.replace(".",""),`.${i.set(n,`${t}-${n}`).get(n)}`)}function Y(e,t,n,r){if(-1<e.indexOf(",")){const s=e.split(","),a=[];for(let e=0;e<s.length;e++)a.push(k(n,t,s[e],r));return a.join(", ")}return k(n,t,e,r)}function B(e,t){let n,i="";for(n in t)0===n.indexOf("--",0)?(i+=`${n}: ${t[n]}; `,delete t[n]):"content"===n&&(i+=`${n}: "${t[n]}"; `,delete t[n]);const r=et.insertRule(`${e} { ${i} } `,et.cssRules.length),s=et.cssRules[r].style;for(n in t)if(!(t[n].constructor===ne))s[n]=t[n];else if(-1<n.indexOf(",")){const r=n.split(",");for(let s=0;s<r.length;s++)"&"===r[s][0]?B(`${e}${r[s].substring(1)}`,t[n]):B(`${e} ${r[s]}`,t[n])}else"&"===n[0]?B(`${e}${n.substring(1)}`,t[n]):B(`${e} ${n}`,t[n])}function A(e,t,n){n.classList.replace(e,t);for(let r=0;r<n.children.length;r++)A(e,t,n.children[r])}function G(e,t,n){const r=ge(e),s=[];for(let a,d,o,l=0;l<r.length;l++)a=r[l],d=Je.get(a)||Symbol(`Synthetic "${a}" event`),o=e[a],Je.has(a)||(te.addEventListener(a,t=>z(t,d)),Je.set(a,d)),s.push(d,me(o)?R(o,n):[t,o]);return s}function z(e,t){for(let n,r,s,i=e.target;null!==i&&!1===e.cancelBubble;){if(n=i[t],n)for(r=n.handlers,s=0;s<r.length&&(e.target.closest(r[s])&&r[s+1].call(n.scope,e),!0!==e.cancelBubble);s+=2);i=i.parentNode}}function R(e,t){const n=[];for(const i in e){let r,s,a=i;"."===i[0]||"#"===i[0]||"["===i[0]||"*"===i[0]||Ke.has(i)||(a="."+i),s=t.has(a)?"."+t.get(a):t.has(r=a.substring(1))?"."+t.get(r):a,n.push(s,e[i])}return n}function q(e){switch(e=e.trim(),e[0]){case"<":return te.createRange().createContextualFragment(e).firstChild;case".":return te.getElementsByClassName(e.substring(1))[0];case"#":return te.getElementById(e.substring(1));case"[":return te.querySelectorAll(e)[0];default:throw new TypeError(`Can't create template from string because it's not html markup or a valid selector.`);}}function W(e){Ve.currentNode=e;const t=[];let n,r=0;do 3!==e.nodeType&&(n=H(e))?(t.push(n,r+1),r=1):r++;while(e=Ve.nextNode());return t}function H(e){if(void 0!==e.attributes)for(let t,n=0;n<e.attributes.length;n++)if(t=e.attributes[n].name,t[0]===Qe)return e.removeAttribute(t),t;return se}function $(e){for(;--e;)Ve.nextNode();return Ve.currentNode}function F(e){const t=new Map;let n,i;for(n in e){if(n[0]!==Qe)throw new ReferenceError(`Reactions must be grouped by refs. Refs are sub-elements of a component that are denoted with "${Qe}name_of_the_ref" in the markup.`);if(!me(e[n]))throw new TypeError(`Reactions of refs must be grouped into objects which map the name of the reactive state property to a reaction handler which modifies the ref element.`);for(i in e[n]){const r={reaction:e[n][i],ref:n};t.has(i)?t.get(i).push(r):t.set(i,[r])}}const r=[];return t.forEach((e,t)=>{r.push(t,function(t){for(let n,r=0;r<e.length;r++)(n=e[r]).reaction.call(this,this[n.ref],t)})}),r}function X(e,t,n,r,s){let d,o,l,p=0,u=0,_=!0,g=t.length-1,h=n.length-1,c=e.firstChild,m=c,f=e.lastChild,v=f;outer:for(;_;){_=!1;let i;for(d=t[p],o=n[u];d===o;){if(s(c,o),p++,u++,m=c=c.nextSibling,g<p||h<u)break outer;d=t[p],o=n[u]}for(d=t[g],o=n[h];d===o;){if(s(f,o),g--,h--,l=f,v=f=f.previousSibling,g<p||h<u)break outer;d=t[g],o=n[h]}for(d=t[g],o=n[u];d===o;){if(_=!0,s(f,o),i=f.previousSibling,e.insertBefore(f,m),v=f=i,u++,g--,g<p||h<u)break outer;d=t[g],o=n[u]}for(d=t[p],o=n[h];d===o;){if(_=!0,s(c,o),i=c.nextSibling,e.insertBefore(c,l),l=v=c,c=i,p++,h--,g<p||h<u)break outer;d=t[p],o=n[h]}}if(h<u){if(p<=g)for(let t;p<=g;)0===g?e.removeChild(f):(t=f.previousSibling,e.removeChild(f),f=t),g--;return}if(g<p){if(u<=h)for(;u<=h;)l?e.insertBefore(r(n[u]),l):e.appendChild(r(n[u])),u++;return}const S=Array(h+1-u),y=new Map;let C;for(C=u;C<=h;C++)S[C]=-1,y.set(n[C],C);let E=0,P=[];for(C=p;C<=g;C++)y.has(t[C])?(S[y.get(t[C])]=C,E++):P.push(C);if(0==E){for(e.textContent="",C=u;C<=h;C++)e.appendChild(r(n[C]));return}const x=J(S,u),T=[];let O=c;for(C=p;C<=g;C++)T[C]=O,O=O.nextSibling;for(C=0;C<P.length;C++)e.removeChild(T[P[C]]);let D,U=x.length-1;for(C=h;C>=u;C--)x[U]===C?(l=T[S[x[U]]],s(l,n[C]),U--):(-1===S[C]?D=r(n[C]):(D=T[S[C]],s(D,n[C])),e.insertBefore(D,l),l=D)}function J(e,t){var r=Math.floor;const s=[],a=[],d=Array(e.length);let o,p,u,_=-1;for(o=t;o<e.length;o++){if(p=e[o],0>p)continue;let t,n=-1,i=s.length;if(0<i&&s[i-1]<=p)u=i-1;else{for(;1<i-n;)t=r((n+i)/2),s[t]>p?i=t:n=t;u=n}-1!==u&&(d[o]=a[u]),u===_?(_++,s[_]=p,a[_]=o):p<s[u+1]&&(s[u+1]=p,a[u+1]=o)}for(o=a[_];0<=_;o=d[o],_--)s[_]=o;return s}function V(e,t){const n=ve(t)?t.call(null,Pe):t;if(!fe(n))throw new TypeError(`Can't create UI Module because the configuration function did not return a plain object.`);if(!n.element)throw new TypeError(`UI Module requires "element" property that specifies a DOM Element. // expect(element).toEqual(HTMLString || Selector || DOMNode).`);let i;const r=(i=q(n.element)).tagName===Ze?te.importNode(i,!0).content.children[0]:i,s=W(r),a=me(n.styles),d=a?n.styles.$scope||e:e,o=a?M(n.styles,r,d):re,l=me(n.render)?F(n.render):ae,p=me(n.events)?G(n.events,d,o):ae,u=ve(n.initialize)?n.initialize:_e;class _ extends tt{constructor(e){const t=r.cloneNode(!0);super(t,o);let n;for(Ve.currentNode=t,n=0;n<s.length;n+=2)this[s[n]]=new tt($(s[n+1]),o);for(u.call(this,e),e&&e!==this.state&&(this.state=e),n=0;n<l.length;n+=2)this.state[ee].addChangeReaction(l[n],l[n+1].bind(this));for(n=0;n<p.length;n+=2)t[p[n]]={scope:this,handlers:p[n+1]}}}for(const i in me(n.imports)&&de(_.prototype,n.imports),n)"initialize"!=i&&ve(n[i])&&(_.prototype[i]=n[i]);return _}function Q(e,t){let n=null;return i=>(null===n&&(n=V(e,t)),new n(i).element)}const ee=Symbol("\u2609"),te=document,ne=Object,ie=Array,re=new Map,se="",ae=[],de=ne.assign,oe=ne.create,le=ne.defineProperty,pe=ne.getPrototypeOf,ue=ne.prototype.toString,_e=()=>{},ge=ne.keys,he=ie.isArray,ce=ie.from,me=e=>"object"==typeof e&&null!==e,fe=e=>me(e)&&(ue.call(e)==="[object Object]"||null===pe(e)),ve=e=>"function"==typeof e,Se=e=>e();let ye=0;const be=e=>{let t,i="",r=ye.toString(26).split("");for(;t=r.shift();)i+="abcdefghijklmnopqrstuvwxyz"[parseInt(t,26)];return ye++,`${e||"cue"}_${i}`},Ce={},Ee=oe(Ce),Pe=oe(Ce),xe={};xe.EventBus=Se(()=>{const e=new Map,t=`Can't add listener because the provided arguments are invalid.`;let n,i,r,s,a,d=[];const o=(t,n,i,r)=>{const s={handler:n,scope:i,once:r};e.has(t)?e.get(t).push(s):e.set(t,[s])},l=(e,t,r)=>{for(n in e)if(i=e[n],ve(i))o(n,i,t,r);else throw new TypeError(`Can't add listener because handler for "${n}" is not a function but of type ${typeof i}`)};return{on:(e,n,i)=>{if(me(e))r=me(n)?n:null,l(e,r,!1);else if("string"==typeof e&&ve(n))r=me(i)?i:null,o(e,n,r,!1);else throw new TypeError(t)},once:(e,n,i)=>{if(me(e))r=me(n)?n:null,l(e,r,!0);else if("string"==typeof e&&ve(n))r=me(i)?i:null,o(e,n,r,!0);else throw new TypeError(t)},off:t=>{e.delete(t)},trigger:(t,...n)=>{if(s=e.get(t)){for(let e=0;e<s.length;e++)a=s[e],a.handler.apply(a.scope,n),a.once&&d.push(a);d.length&&(e.set(t,s.filter(e=>-1===d.indexOf(e))),d.splice(0,d.length)),s=null}}}});const Te=new Map,Oe=new Map,De=new Map,Ue=new Map,Ne=new Map,je={derivative:null,allProperties:null,derivedProperties:null},we=-1,Le=1,Ie=-1,Me=1,ke=2,Ye=1,Be=2,Ae={};le(Ae,ee,{value:{name:"::ROOT::",type:Ie,plainState:Ae,proxyState:Ae,observersOf:re,derivativesOf:re,internalGetters:re,internalSetters:re,propertyDidChange:_e}});const Ge=new Map([["fill",()=>t],["push",()=>n],["unshift",()=>i],["splice",()=>r],["pop",()=>s],["shift",()=>a],["copyWithin",()=>d],["reverse",()=>o],["sort",()=>l]]);class ze{constructor(e,t,n){this.ownPropertyName=e,this.computation=t,this.sourceProperties=n,this.subDerivatives=[],this.superDerivatives=[],this.observers=[],this.source=void 0,this.intermediate=void 0,this._value=void 0,this._type=-1,this.needsUpdate=!0,this.stopPropagation=!1,this.hasChanged=!1}value(){return!0===this.needsUpdate&&(this.intermediate=this.computation.call(this.source,this.source),he(this.intermediate)?(this.hasChanged=this._type!==Be||this.intermediate.length!==this._value.length||!m(this._value,this.intermediate))&&(this._value=this.intermediate.slice(),this._type=Be):"object"==typeof this.intermediate&&null!==this.intermediate?(this.hasChanged=this._type!==Ye||!f(this._value,this.intermediate))&&(this._value=de({},this.intermediate),this._type=Ye):(this.hasChanged=this._value!==this.intermediate)&&(this._value=this.intermediate,this._type=0),this.needsUpdate=!1),this._value}}const Re={source:null,visited:[],from(e){this.source=e;const t=new Map;let n;for(n of e.keys())this._visit(n,[],t);return this.source=null,this.visited.splice(0,this.visited.length),t},_visit(e,t,n){if(this.source.has(e)){t.push(e),this.visited.push(e);const r=this.source.get(e);for(let e,s=0;s<r.sourceProperties.length;s++){if(e=r.sourceProperties[s],-1!==t.indexOf(e))throw new Error(`Circular dependency. "${r.ownPropertyName}" is required by "${e}": ${t.join(" -> ")}`);-1===this.visited.indexOf(e)&&this._visit(e,t,n)}n.has(e)||n.set(e,r)}}};let qe=null,We=!1;class He{constructor(e,t){this.type=t,this.valueCache=new Map,this.module=e,this.imports=e.imports,this.mounted=!1,this.internalGetters=re,this.internalSetters=re}bubble(){let e=this.directParent,t=this.ownPropertyName,n=this.proxyState;for(;e.type===Me;)e.cueObservers.call(e,t,n),e.cueDerivatives.call(e,t),t=e.ownPropertyName,n=e.proxyState,e=e.directParent;if(e.type!==Ie){let t=e.closestModuleParent,n=e.branchPropertyName;for(;t&&t.type!==Ie;)t.cueDerivatives.call(t,n),n=t.branchPropertyName,t=t.closestModuleParent}}}class $e extends He{constructor(e,t){super(e,t)}instanceDidMount(e,t){this.directParent=e[ee],this.ownPropertyName=t;let n=this.directParent,i=t;for(;n&&n.type!==Me;)i=n.ownPropertyName,n=n.closestModuleParent;this.closestModuleParent=n,this.branchPropertyName=i,this.name=this.module.name,this.internalGetters=this.module.internalGetters,this.internalSetters=this.module.internalSetters,this.observersOf=new Map,this.derivativesOf=new Map,this.derivedProperties=new Map,this.module.derivativesToInstall.size&&this.installDerivatives(),this.mounted=!0,this.module.initialize.call(this.proxyState,this.initialProps),this.initialProps=void 0}propertyDidChange(e,t){this.cueObservers(e,t),this.cueDerivatives(e),this.bubble()}cueObservers(e,t){if(this.observersOf.has(e)){const n=this.observersOf.get(e);for(let e=0;e<n.length;e++)De.set(n[e],t)}}cueDerivatives(e){if(this.derivativesOf.has(e)){const t=this.derivativesOf.get(e);for(let e,n=0;n<t.length;n++)e=t[n],Ue.has(e)||Ue.set(e,this)}}injectProviders(){let e,t,n,i,r,s;for(e of this.module.providersToInstall.values())if(!1===e.readOnly){t=e.sourceModule,n=e.sourceProperty,i=e.targetModule,r=e.targetProperty;let a=this.closestModuleParent;for(;a&&a.name!==t;)a=a.closestModuleParent;if(a)s=a.providersOf.get(n),s=s?getRootProvider(s):{sourceInternals:a,sourceProperty:n,targetModule:i,targetProperty:r},this.providersOf.set(r,s);else throw new Error(`[${i}]: Can't inject "${r}" from "${t}" because it's not an ancestor of the injecting module instance.`)}}installDerivatives(){let e,t,n,r,s;for(e of this.module.derivativesToInstall.values()){for(n=new ze(e.ownPropertyName,e.computation,e.sourceProperties),this.derivedProperties.set(e.ownPropertyName,n),t=0;t<e.sourceProperties.length;t++)r=e.sourceProperties[t],this.derivativesOf.has(r)?this.derivativesOf.get(r).push(n):this.derivativesOf.set(r,[n]);for(t=0;t<e.superDerivatives.length;t++)s=this.derivedProperties.get(e.superDerivatives[t].ownPropertyName),n.superDerivatives.push(s),s.subDerivatives.push(n);n.source=this.proxyState}}addChangeReaction(e,t){if(this.observersOf.has(e)?this.observersOf.get(e).push(t):this.observersOf.set(e,[t]),this.derivedProperties.has(e)){const n=this.derivedProperties.get(e);n.observers.push(t),C(n,we)}De.set(t,this.proxyState[e]),U()}removeChangeReaction(e,t){if(this.observersOf.has(e)){const n=this.observersOf.get(e),r=this.derivedProperties.get(e);if(t===void 0)this.observersOf.delete(e),r&&(r.observers.splice(0,r.observers.length),C(r,Le));else if(ve(t)){let s=n.indexOf(t);-1<s?n.splice(s,1):console.warn(`Can't remove the passed handler from reactions of "${e}" because it is not registered.`),r&&(s=r.observers.indexOf(t),-1<s?(r.observers.splice(s,1),C(r,Le)):console.warn(`Can't remove the passed handler from observers of derived property "${e}" because it is not registered.`))}}else console.warn(`Can't unobserve property "${e}" because no reaction has been registered for it.`)}}class Fe extends He{constructor(e,t){super(e,t)}instanceDidMount(e,t){this.directParent=e[ee],this.ownPropertyName=t;let n=this.directParent,i=t;for(;n&&n.type!==Me;)i=n.ownPropertyName,n=n.closestModuleParent;this.closestModuleParent=n,this.branchPropertyName=i,this.internalGetters=Ge,this.mounted=!0}propertyDidChange(){this.bubble()}}de(Ee,{import:e=>{const t=Te.get(e);if(!t)throw new ReferenceError(`Can't import undefined State Module "${e}".`);return t}}),xe.State={register:(e,t)=>{if("string"!=typeof e)throw new TypeError(`Can't create Cue State Module. First argument must be name of type string but is of type "${typeof e}".`);else if(Te.has(e))throw new Error(`A State Module has already been registered under name "${e}". Unregister, use a unique name or consider namespacing.with.dots-or-hyphens...`);const n={name:e};Oe.set(e,n);const i=I(n,t);return Te.set(e,i),i},isState:e=>e&&e[ee]};const Xe=new Map,Je=new Map,Ve=te.createTreeWalker(te,NodeFilter.SHOW_ALL,null,!1),Qe="$",Ze="TEMPLATE";de(Pe,{import:e=>{const t=Xe.get(e);if(!t)throw new ReferenceError(`Can't import UI Component because nothing is registered under "${e}".`);return t}});const Ke=new Set(["abbr","address","area","article","aside","audio","b","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","command","datalist","dd","del","details","dfn","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","main","map","mark","menu","meter","nav","object","ol","optgroup","option","output","p","param","pre","progress","q","rp","rt","ruby","s","samp","section","select","small","source","span","strong","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","tr","track","u","ul","var","video","wbr"]),et=Se(()=>{const e=te.createElement("style");return e.id="CUE-STYLES",te.head.appendChild(e),e.sheet}),tt=Se(()=>{const e=NodeList.prototype.isPrototypeOf,t=HTMLCollection.prototype.isPrototypeOf,n=Se(()=>{const e=te.createElement("tst"),n={transition:{run:"transitionrun",start:"transitionstart",end:"transitionend"},WebkitTransition:{run:"webkitTransitionRun",start:"webkitTransitionStart",end:"webkitTransitionEnd"},MozTransition:{run:"transitionRun",start:"transitionStart",end:"transitionEnd"},MSTransition:{run:"msTransitionRun",start:"msTransitionStart",end:"msTransitionEnd"},OTransition:{run:"oTransitionRun",start:"oTransitionStart",end:"oTransitionEnd"}};for(const i in n)if(e.style[i])return n[i]}),r=Symbol("ScopedStyles"),s=Symbol("ChildData");return class a{constructor(e,t){this.element=e,e[ee]=this,this[r]=t,this[s]=[]}get(n){if("string"==typeof n){let e,t;switch(n[0]){case"#":e=te.getElementById(n.substring(1));break;case".":e=this.element.getElementsByClassName(this[r].get(t=n.substring(1))||t);break;default:e=this.element.querySelectorAll(n);}return e.nodeType!==Node.TEXT_NODE&&e.length?1===e.length?e[0][ee]||new a(e[0],this[r]):ce(e).map(e=>e[ee]||new a(e,this[r])):e[ee]||new a(e,this[r])}return n instanceof Element?n[ee]||new a(n,this[r]):e(n)||t(n)?ce(n).map(e=>e[ee]||new a(e,this[r])):n&&n[r]?n:void 0}getSiblings(e=!1){const t=this.element.parentNode.childNodes,n=[];if(!0===e)for(let e,s=0;s<t.length;s++)e=t[s],n.push(e[ee]||new a(e,this[r]));else for(let e,s=0;s<t.length;s++)e=t[s],e!==this.element&&n.push(e[ee]||new a(e,this[r]));return n}getChildren(){const e=ce(this.element.parentNode.childNodes);for(let t,n=0;n<e.length;n++)t=e[n],e[n]=t[ee]||new a(t,this[r]);return e}setChildren(e,t,n=_e){const i=this[s];if(this[s]=e.slice(),0===e.length)this.element.textContent="";else if(0===i.length)for(let n=0;n<e.length;n++)this.element.appendChild(t(e[n]));else X(this.element,i,e,t,n);return this}append(e){return e instanceof Element?this.element.appendChild(e):e&&e[r]&&this.element.appendChild(e.element),this}appendTo(e){return e instanceof Element?e.appendChild(this.element):e&&e[r]&&e.element.appendChild(this.element),this}insertBefore(e){return e instanceof Element?e.parentNode.insertBefore(this.element,e):(e&&e[r]||(e=this.get(e)))&&e.element.parentNode.insertBefore(this.element,e.element),this}insertAfter(e){e instanceof Element?e.parentNode.insertBefore(this.element,e.nextSibling):(e&&e[r]||(e=this.get(e)))&&e.element.parentNode.insertBefore(this.element,e.element.nextSibling)}moveTo(e,t){t=t?this.get(t):this.element.parentNode;const n=t.children;return e>=n.length?t.appendChild(this.element):0>=e?t.insertBefore(this.element,t.firstChild):t.insertBefore(this.element,n[e>=ce(n).indexOf(this.element)?e+1:e]),this}getText(){return this.element.textContent}setText(e){return this.element.textContent=e,this}getAttr(e){return this.element.getAttribute(e)}setAttr(e,t){return this.element.setAttribute(e,t),this}getData(e){return this.element.dataset[e]}setData(e,t){return this.element.dataset[e]=t,this}getIndex(e){return e instanceof Element?ce(e.parentNode.children).indexOf(e):e&&e[r]?ce(e.element.parentNode.children).indexOf(e.element):ce(this.element.parentNode.children).indexOf(this.element)}hasClass(e){return this.element.classList.contains(this[r].get(e)||e)}addClass(...e){for(let t,n=0;n<e.length;n++)t=this[r].get(e[n])||e[n],this.element.classList.add(t);return this}removeClass(...e){for(let t,n=0;n<e.length;n++)t=this[r].get(e[n])||e[n],this.element.classList.remove(t);return this}toggleClass(...e){for(let t,n=0;n<e.length;n++)t=this[r].get(e[n])||e[n],this.element.classList.toggle(t);return this}replaceClass(e,t){return this.element.classList.replace(this[r].get(e)||e,this[r].get(t)||t),this}useClass(e,t=!0){return this.element.classList.toggle(this[r].get(e)||e,t),this}awaitTransition(){return new Promise(t=>{this.element.addEventListener(n.end,n=>t(n),{once:!0})})}}});xe.UI={register:(e,t)=>{if("string"!=typeof e)throw new TypeError(`Can't create Cue-UI Module. First argument must be name of type string but is of type "${typeof e}".`);else if(!t||"function"!=typeof t&&!fe(t))throw new TypeError(`Can't create Cue-UI Module. Second argument must be module initializer function or configuration object but is of type "${typeof t}".`);else if(Xe.has(e))throw new Error(`A UI Module has already been registered under name "${e}". Unregister, use a unique name or consider namespacing.with.dots-or-hyphens...`);const n=Q(e,t);return Xe.set(e,n),n},isComponent:e=>e instanceof ComponentPrototype};const nt=new Map,it={core:Ce,state:Ee,ui:Pe},rt=e=>"string"==typeof e&&2<e.length&&-1!==e.indexOf("-"),st=e=>e.split("-"),at=(e,t)=>e.didInstall?e.extensionPoint:(e.extensionPoint=e.installer.call(null,it,t),e.didInstall=!0,e.extensionPoint);xe.Plugin={register:(e,t,n)=>{if(!rt(e))throw new Error(`Plugin must be defined with a namespaced-name (vendor-plugin) of type string as the first argument.`);const[i,r]=st(e);if(!t&&!n){const t=nt.get(i);if(t){const n=t.get(r);if(n)return n;throw new Error(`No Plugin with name ${e} has been registered under "${i}".`)}else throw new Error(`No Plugin has been registered under "${t}".`)}else{if("function"!=typeof t)throw new Error(`Plugin must be defined with an installable function as the second argument.`);const s=nt.get(i)||nt.set(i,new Map).get(i);if(s.has(r))return console.warn(`A plugin with name "${r}" has already been registered under "${i}". Skipping installation...`),s.get(r).name;const a={installer:t,didInstall:!1,name:e,extensionPoint:void 0};return s.set(r,a),n&&at(a),e}},use:(e,t)=>{if(!rt(e))throw new Error(`pluginName must be a namespaced-string (vendor-plugin).`);const[n,i]=st(e),r=nt.get(n);if(r){const e=r.get(i);if(e)return at(e,t)}throw new Error(`No Plugin has been registered under "${e}".`)}};class dt{constructor(e){if(!me(e))throw new TypeError("Cue config must be an object.");this.stateModule=e.state,this.stateInstance=null,this.stateInternals=null,this.uiComponent=e.ui,this.uiElement=null,this.mounted=!1}mount(e,t=void 0){if(!0===this.mounted)throw new Error("Cue instance already mounted.");let n;"string"==typeof this.stateModule?n=this.stateModule:("function"==typeof this.stateModule||"object"==typeof this.stateModule)&&(n=be("cue_module"),xe.State.register(n,this.stateModule));let i;"string"==typeof this.uiComponent?i=this.uiComponent:("function"==typeof this.uiComponent||"object"==typeof this.uiComponent)&&(i=be("cue_component"),xe.UI.register(i,this.uiComponent));const r=Ee.import(n),s=Pe.import(i);if(e="string"==typeof e?te.querySelector(e):e instanceof Element?e:void 0,!e)throw new TypeError(`Target must be a valid DOM Element or DOM Selector String.`);const a=this.stateInstance=r(t),d=this.stateInternals=a[ee];d.instanceDidMount(Ae,n);const o=this.uiElement=s(a);return e.appendChild(o),this.mounted=!0,this}unmount(){if(!1===this.mounted)throw new Error(`Can't unmount Cue instance because it has not been mounted.`);return this.uiElement.parentElement.removeChild(this.uiElement),this.uiElement=null,this.stateInstance=null,this.stateInternals=null,this.mounted=!1,this}getState(e){if(!this.stateInstance)throw new ReferenceError(`State can't be "${typeof this.stateInstance}" when getting it. Mount the Cue Instance first.`);else return this.stateInternals.proxyState.get(e)}setState(e){if(!this.stateInstance)throw new ReferenceError(`State can't be "${typeof this.stateInstance}" when setting it. Mount the Cue Instance first.`);else this.stateInternals.proxyState.set(e);return this}}const ot=e.Cue=e=>new dt(e);Object.defineProperties(ot,{on:{value:xe.EventBus.on},once:{value:xe.EventBus.once},off:{value:xe.EventBus.off},trigger:{value:xe.EventBus.trigger},Plugin:{value:xe.Plugin.register},usePlugin:{value:xe.Plugin.use},State:{value:xe.State.register},isState:{value:xe.State.isState},UI:{value:xe.UI.register},isComponent:{value:xe.UI.isComponent}})})(window||this);