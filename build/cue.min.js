(function(e){var V=Math.min,J=Math.max;function t(e,t=0,n=this.length){if(0===arguments.length||0===this.length||t===n)return this;const r=this[we],s=r.plainState;let l=!1;if(e&&e[we]){if(1<this.length)throw new Error(`You can not fill an Array with multiple copies of the same state instance.`);const t=s[0];t!==e&&(s[0]=e,l=!0,e[we].instanceDidMount(s,0))}else for(let r,a=t;a<n;a++)r=s[a],r!==e&&(s[a]=e,l=!0);return l&&(r.propertyDidChange(),T()),this}function n(...e){if(0<e.length){const t=this[we],n=t.plainState;for(let t,r,s=0;s<e.length;s++)t=e[s],n.push(t),t&&(r=t[we])&&r.instanceDidMount(n,s);t.propertyDidChange(),T()}return this.length}function r(...e){if(0<e.length){const t=this[we],n=t.plainState;for(let t,r,s,l=e.length;0<=--l;)t=e[l],r=n[0],n.unshift(t),t&&(s=t[we])&&s.instanceDidMount(n,0);t.propertyDidChange(),T()}return this.length}function s(e,t,...n){const r=this[we],s=r.plainState,i=s.length,l=0>e?J(i+e,0):V(e,i);let a,o;1===arguments.length?(a=0,o=i-l):(a=n.length,o=V(J(t,0),i-l));const d=[];if(0<o)for(let e,t,n=l+o;--n>=l;)e=s[n],e&&(t=e[we])&&t.instanceWillUnmount(),s.splice(n,1),d.push(e);if(0<a)for(let e,t,r,o=0;o<a;o++)e=n[o],t=l+o,s.splice(t,0,e),e&&(r=e[we])&&r.instanceDidMount(s,t);return r.propertyDidChange(),T(),d}function i(){const e=this[we],t=e.plainState;if(0===t.length)return;const n=t[t.length-1],r=n?n[we]:void 0;return r&&r.instanceWillUnmount(),delete t[t.length-1],e.propertyDidChange(),T(),n}function l(){const e=this[we],t=e.plainState;if(0===t.length)return;const n=t[0],r=n?n[we]:void 0;return r&&r.instanceWillUnmount(),t.shift(),e.propertyDidChange(),T(),n}function a(e,t=0,n=this.length){const r=this[we],s=r.plainState,i=s.length;let l=0>e?J(i+e,0):V(e,i),a=0>t?J(i+t,0):V(t,i);const o=0>n?J(i+n,0):V(n,i);let d,u=V(o-a,i-l);a<l&&l<a+u?(d=-1,a=a+u-1,l=l+u-1):d=1;for(let r,i;0<u;){if(a in s){if(r=s[a],r&&r[we])throw new Error(`You can't create copies of Cue State Instances via Array.prototype.copyWithin.`);s[l]=s[a]}else r=s[l],r&&(i=r[we])&&i.instanceWillUnmount(),delete s[l];a+=d,l+=d,u-=1}return r.propertyDidChange(),T(),s}function o(){const e=this[we],t=e.plainState;return t.reverse(),e.propertyDidChange(),T(),t}function d(e){const t=this[we],n=t.plainState;return n.sort(e),t.propertyDidChange(),T(),n}function u(e){const t={},n=oe(e);for(let r,s,l=0;l<n.length;l++)r=n[l],s=e[r],t[r]=s?de(s)?p(s):"object"==typeof s?u(s):s:s;return t}function p(e){const t=[];for(let n,r=0;r<e.length;r++)n=e[r],t[r]=n?de(n)?p(n):"object"==typeof n?u(n):n:n;return t}function g(e,t,n,r="id"){const s=e[t];if(n!==s){if(null===s||void 0===s||null===n||"object"!=typeof n)return void(void 0===n?delete e[t]:e[t]=n);if(de(n)){if(n.length&&s.length&&r&&null!=n[0][r]){let e,t,i,l,a,o,d,u,p=Array(n.length),c=new Map;for(i=0,l=V(s.length,n.length);i<l&&(s[i]===n[i]||r&&s[i][r]===n[i][r]);i++)g(s,i,n[i],r);for(l=s.length-1,a=n.length-1;0<=l&&0<=a&&(s[l]===n[a]||r&&s[l][r]===n[a][r]);l--,a--)p[a]=s[l];for(d=Array(a+1),t=a;t>=i;t--)o=n[t],u=r?o[r]:o,e=c.get(u),d[t]=void 0===e?-1:e,c.set(u,t);for(e=i;e<=l;e++)o=s[e],u=r?o[r]:o,t=c.get(u),void 0!==t&&-1!==t&&(p[t]=s[e],t=d[t],c.set(u,t));for(t=i;t<n.length;t++)p.hasOwnProperty(t)?(s[t]!==p[t]&&(void 0===p[t]?delete s[t]:s[t]=p[t]),g(s,t,n[t],r)):s[t]!==n[t]&&(void 0===n[t]?delete s[t]:s[t]=n[t])}else for(let e=0,t=n.length;e<t;e++)g(s,e,n[e],r);s.length>n.length&&(s.length=n.length)}else{const e=Object.keys(n);for(let t=0,i=e.length;t<i;t++)g(s,e[t],n[e[t]],r);const t=Object.keys(s);for(let e=0,r=t.length;e<r;e++)void 0===n[t[e]]&&void 0!==s[t[e]]&&delete s[t[e]]}}}function c(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){const n=de(e),r=de(t);if(n!==r)return!1;if(n&&r)return v(e,t);const s=e.constructor===H,i=t.constructor===H;if(s!==i)return!1;if(s&&i)return h(e,t)}return e!==e&&t!==t}function h(e,t){const n=oe(e),r=oe(t);if(n.length!==r.length)return!1;for(let s,l=0;l<n.length;l++)if(s=n[l],-1===r.indexOf(s)||e[s]!==t[s])return!1;return!0}function v(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function f(e=!1){const t=this[we],n=de(t.plainState)?p(t.plainState):u(t.plainState);return e?JSON.stringify(n):n}function m(e){const t=this[we];e.constructor===String&&(e=JSON.parse(e)),Oe=!0,g(t.rootInternals.proxyState,t.rootPropertyName,e),Oe=!1,w(),T()}function y(e){const t=e.sourceInternals.providersOf.get(e.sourceProperty);return t?y(t):e}function _(e,t,n,r){const s={targetModule:e,targetProperty:t,sourceModule:n,sourceProperty:r},l=Ee.get(n);if(l.consumersOf.has(r)){const a=l.consumersOf.get(r);let o=!1,d=-1;for(;++d<a.length&&!1==o;)a[d].targetModule===e&&a[d].targetProperty===t&&a[d].sourceModule===n&&a[d].sourceProperty===r&&(o=!0);!1==o&&l.consumersOf.get(r).push(s)}else l.consumersOf.set(r,[s])}function P(e,t){$(Ue,{allProperties:e,computedProperties:t});const n=new Proxy(e,{get:C});let r;for(r of t.values()){Ue.derivative=r;try{r.computation.call(n,n)}catch(t){}}Ue.derivative=null,Ue.allProperties=null,Ue.computedProperties=null}function C(e,t){const{derivative:n,allProperties:r,computedProperties:s}=Ue;if(!r.hasOwnProperty(t))throw new Error(`Unable to resolve dependency "${t}" of computed prop "${n.ownPropertyName}".`);if(-1===n.sourceProperties.indexOf(t)&&n.sourceProperties.push(t),s.has(t)){const e=s.get(t);-1===e.subDerivatives.indexOf(n)&&e.subDerivatives.push(n),-1===n.superDerivatives.indexOf(e)&&n.superDerivatives.push(e)}}function E(e,t){t===xe?(b(e),S(e)):t===je&&O(e)}function b(e){if(e.superDerivatives.length)for(let t,n=0;n<e.superDerivatives.length;n++)t=e.superDerivatives[n],t.stopPropagation=!1,t.superDerivatives.length&&b(t)}function S(e,t=!0){if(e.stopPropagation=t,e.subDerivatives.length)for(let t,n=0;n<e.subDerivatives.length;n++)t=e.subDerivatives[n],t.observers.length&&(e.stopPropagation=!1,S(t))}function O(e,t=!1){e.stopPropagation=t;for(let n,r=0;r<e.superDerivatives.length;r++)n=e.superDerivatives[r],n.observers.length?n.stopPropagation=!0:O(n)}function I(e,t){if(t===we)return e[we];if("imports"===t)return e[we].imports;const n=e[we];if(n.internalGetters.has(t))return n.internalGetters.get(t)(n);const r=e[t];if(!r||r[we]||"object"!=typeof r)return r;else{console.count("[get] create subState");let n=e[we];for(;n.type!==Ne;)n=n.rootInternals;const s=k(r,n.module,ke,null);return e[t]=s.proxyState,s.internals.instanceDidMount(e,t),s.proxyState}}function D(e,t,n){const r=e[we],s=n?n[we]:void 0;return s&&!1===s.mounted&&s.instanceDidMount.call(s,e,t),r.internalSetters.has(t)?(r.internalSetters.get(t)(r,n),!0):n===r.valueCache.get(t)?void 0:(e[t]=n,r.propertyDidChange.call(r,t,n),r.valueCache.set(t,n),T(),!0)}function U(e,t){if(!!Se)console.warn(`Deletion of "${t}" ignored. Don't mutate state in a reaction. Refactor to computed properties instead.`);else if(e.hasOwnProperty(t)){const n=e[we],r=n.providersOf.get(t);if(r){const e=y(r);return delete e.sourceInstance.plainState[e.sourceProperty],!0}return n.propertyDidChange.call(n,t,void 0),delete e[t],n.valueCache.delete(t),T(),!0}}function x(e,t,n,r,s,a){let o,d,u;if(r){const e={value:t,path:n};for(o=0;o<r.length;o++)u=r[o],-1===De.indexOf(u)&&De.push(u,e)}if(s&&(d=s.length)&&!1===a){for(o=0;o<d;o++)s[o].updateProperty(e,t);let n;for(o=0;o<d;o++)u=s[o],n=u.value,u.hasChanged&&x(u.ownPropertyName,n,u.ownPropertyName,u.observers,u.subDerivatives,u.stopPropagation)}}function j(e,t,n,r,s,l){let a,o,d;if(r){const e={value:t,oldValue:n};for(a=0;a<r.length;a++)o=r[a],-1===De.indexOf(o)&&De.push(o,e)}if(s&&!1===l)for(a=0;a<s.length;a++)d=s[a],d.updateProperty(e,t),-1===Ie.indexOf(d)&&Ie.push(d)}function w(){for(let e,t,n,r=0;r<Ie.length;r++)e=Ie[r],t=e._value,n=e.value,e.hasChanged&&x(e.ownPropertyName,n,t,e.observers,e.subDerivatives,e.stopPropagation);Ie.splice(0,Ie.length)}function T(){if(De.length&&!Oe){Se=!0;for(let e=0;e<De.length;e+=2)De[e](De[e+1]);De.splice(0,De.length),Se=!1}}function N(e,t){const n=ce(t)?t(ye):t;if(!ge(n))throw new TypeError(`Can't create State Module "${e.name}" because the config function does not return a plain object.`);if(!ge(n.props))throw new TypeError(`State Module requires "props" pojo containing default and optional computed properties.`);for(const r in e.imports=n.imports,e.defaults={},e.initialize=le,e.consumersOf=new Map,e.internalGetters=new Map([["get",()=>f],["set",()=>m]]),e.internalSetters=new Map,e.derivativesToInstall=new Map,e.providersToInstall=new Map,n.props){const t=n.props[r];ce(t)?(e.derivativesToInstall.set(r,{ownPropertyName:r,computation:t,sourceProperties:[],subDerivatives:[],superDerivatives:[]}),e.internalGetters.set(r,e=>e.derivedProperties.get(r).value)):t instanceof Be?(t.targetModule=e.name,t.targetProperty=r,e.providersToInstall.set(r,t),_(e.name,r,t.sourceModule,t.sourceProperty),e.internalGetters.set(r,e=>{const t=e.providersOf.get(r);return t.sourceInternals.plainState[t.sourceProperty]}),!1===t.readOnly&&e.internalSetters.set(r,(e,t)=>{const n=e.providersOf.get(r);n.sourceInternals.proxyState[n.sourceProperty]=t})):e.defaults[r]=t}for(const r in P(n.props,e.derivativesToInstall),e.derivativesToInstall=qe.from(e.derivativesToInstall),n){const t=n[r];if("initialize"==r){if(ce(t))e.initialize=t;else throw new TypeError(`"${r}" is a reserved word for Cue State Modules and must be a function but is of type "${typeof t}"`);}else if(ce(t))if(!e.internalGetters.has(r))e.internalGetters.set(r,t);else throw new Error(`Module method name "${r}" clashes with a property from "props" or with a default Cue property ("get" and "set" are reserved properties). Make sure that props and method names are distinct.`)}return e}function k(e,t,n,r){const s=e[we]=new Le(t,n),i=new Proxy(e,{get:I,set:D,deleteProperty:U});return s.plainState=e,s.proxyState=i,4===arguments.length&&(s.initialProps=r),{plainState:e,proxyState:i,internals:s}}function R(e,t){return n=>{e=N(e,t);const r=t=>{const n=u(e.defaults);return k(n,e,Ne,t).proxyState};return Ce.set(name,r),r(n)}}function M(e,t,n){n.classList.replace(e,t);for(let r=0;r<n.children.length;r++)M(e,t,n.children[r])}function B(e,t){const n=new Map;if(!e)return n;let r,s,i,l,a,o,d,u;for(r in e){for(i in o=fe(r),d=Ge.insertRule(`.${o} {}`,Ge.cssRules.length),u=Ge.cssRules[d].style,s=e[r],s)pe(s[i])&&(l="&"===i[0]?Ge.insertRule(`.${o}${i.substring(1)} {}`,Ge.cssRules.length):Ge.insertRule(`.${o} ${i} {}`,Ge.cssRules.length),a=Ge.cssRules[l].style,$(a,s[i]),delete s[i]);$(u,s),n.set(r,o),t&&M(r,o,t)}return n}function z(e){const t=new Map;if(!e)return t;let n,r,s,i,l,a,o,d;for(n in e){for(a in r=fe(n),s=Ge.insertRule(`@keyframes ${r} {}`,Ge.cssRules.length),i=Ge.cssRules[s],l=e[n],l)i.appendRule(`${a}% {}`),o=i.cssRules.length-1,d=i.cssRules[o].style,$(d,l[a]);t.set(n,r)}return t}function q(e){if("string"==typeof e)switch(e=e.trim(),e[0]){case"<":return document.createRange().createContextualFragment(e).firstChild;case".":return document.getElementsByClassName(e.substring(1))[0];case"#":return document.getElementById(e.substring(1));case"[":return document.querySelectorAll(e)[0];default:throw new TypeError(`Can't create template from string because it's not html markup or a valid selector.`);}else if(e instanceof Element)return e}function L(e,t,n,r,s){let l,o,d,u=0,p=0,g=!0,c=t.length-1,h=n.length-1,v=parent.firstChild,f=v,m=parent.lastChild,y=m;outer:for(;g;){g=!1;let e;for(l=t[u],o=n[p];l===o;){if(s(v,o),u++,p++,f=v=v.nextSibling,c<u||h<p)break outer;l=t[u],o=n[p]}for(l=t[c],o=n[h];l===o;){if(s(m,o),c--,h--,d=m,y=m=m.previousSibling,c<u||h<p)break outer;l=t[c],o=n[h]}for(l=t[c],o=n[p];l===o;){if(g=!0,s(m,o),e=m.previousSibling,parent.insertBefore(m,f),y=m=e,p++,c--,c<u||h<p)break outer;l=t[c],o=n[p]}for(l=t[u],o=n[h];l===o;){if(g=!0,s(v,o),e=v.nextSibling,parent.insertBefore(v,d),d=y=v,v=e,u++,h--,c<u||h<p)break outer;l=t[u],o=n[h]}}if(h<p){if(u<=c)for(let e;u<=c;)0===c?parent.removeChild(m):(e=m.previousSibling,parent.removeChild(m),m=e),c--;return}if(c<u){if(p<=h)for(;p<=h;)d?parent.insertBefore(r(n[p]),d):parent.appendChild(r(n[p])),p++;return}const _=Array(h+1-p),P=new Map;let C;for(C=p;C<=h;C++)_[C]=-1,P.set(n[C],C);let E=0,S=[];for(C=u;C<=c;C++)P.has(t[C])?(_[P.get(t[C])]=C,E++):S.push(C);if(0==E){for(parent.textContent="",C=p;C<=h;C++)parent.appendChild(r(n[C]));return}const O=A(_,p),I=[];let D=v;for(C=u;C<=c;C++)I[C]=D,D=D.nextSibling;for(C=0;C<S.length;C++)parent.removeChild(I[S[C]]);let U,x=O.length-1;for(C=h;C>=p;C--)O[x]===C?(d=I[_[O[x]]],s(d,n[C]),x--):(-1===_[C]?U=r(n[C]):(U=I[_[C]],s(U,n[C])),parent.insertBefore(U,d),d=U)}function A(e,t){const r=[],s=[],a=Array(e.length);let o,d,u,p=-1;for(o=t;o<e.length;o++){if(d=e[o],0>d)continue;let t,n=-1,i=r.length;if(0<i&&r[i-1]<=d)u=i-1;else{for(;1<i-n;)t=FLOOR((n+i)/2),r[t]>d?i=t:n=t;u=n}-1!==u&&(a[o]=s[u]),u===p?(p++,r[p]=d,s[p]=o):d<r[u+1]&&(r[u+1]=d,s[u+1]=o)}for(o=s[p];0<=p;o=a[o],p--)r[p]=o;return r}function G(e,t){const n=e.state[we];let r,s;for(r in t)s=n.addChangeReaction.call(n,r,t[r],e,e.autorun),e.reactions.has(r)?e.reactions.get(r).push(s):e.reactions.set(r,[s])}function W(t,n){let r,s;for(r in n)if(s=n[r],t.events.has(r))F(t.events.get(r),s,t);else{const n=[];t.events.set(r,n),F(n,s,t),t.element.addEventListener(r,r=>{for(let e=0;e<n.length;e++)n[e].call(t,r)})}}function F(e,t,n){if(ce(t))e.push(t);else if(pe(t))for(const r in t)e.push(s=>s.target.closest(r)&&t[r].call(n,s))}function X(e){const t="function"==typeof e?e.call(null,_e):e;if(!ge(t))throw new TypeError(`Can't create UI Module because the configuration function did not return a plain object.`);if(!t.template)throw new TypeError(`UI Module requires "template" property that specifies a DOM Element. // expect(template).toEqual(HTMLString || Selector || DOMNode).`);const n=q(t.template),r=B(t.styles,n),s=z(t.keyframes);if(t.bindEvents&&0<r.size){let e,n,s,i;for(e in t.bindEvents)if(n=t.bindEvents[e],pe(n))for(s in n)"."===s[0]&&(i=r.get(s.substring(1)),i&&(n["."+i]=n[s],delete n[s]))}return{template:n,imports:t.imports||null,styles:r,keyframes:s,initialize:t.initialize||null,bindEvents:t.bindEvents||null,renderState:t.renderState||null}}function Y(e){let t=null;return n=>{t||(t=X(e));const r=new We(t.template.cloneNode(!0),t.imports,t.styles,t.keyframes);return t.initialize&&t.initialize.call(r,n),t.renderState&&G(r,t.renderState),t.bindEvents&&W(r,t.bindEvents),r.element}}const H=Object,Q=Array,Z=new Map,$=H.assign,K=H.create,ee=H.defineProperty,te=H.defineProperties,ne=H.getPrototypeOf,re=H.setPrototypeOf,se=H.getOwnPropertyDescriptors,ie=H.prototype.toString,le=()=>{},ae=Reflect.construct,oe=H.keys,de=Q.isArray,ue=Q.from,pe=e=>"object"==typeof e&&null!==e,ge=e=>pe(e)&&(ie.call(e)==="[object Object]"||null===ne(e)),ce=e=>"function"==typeof e,he=e=>e();let ve=0;const fe=e=>{let t,r="",s=ve.toString(26).split("");for(;t=s.shift();)r+="abcdefghijklmnopqrstuvwxyz"[parseInt(t,26)];return ve++,`${e||"cue"}_${r}`},me={},ye=K(me),_e=K(me),Pe={};Pe.EventBus=he(()=>{const e=new Map,t=`Can't add listener because the provided arguments are invalid.`;let n,r,s,l,a,o=[];const d=(t,n,r,s)=>{const i={handler:n,scope:r,once:s};e.has(t)?e.get(t).push(i):e.set(t,[i])},u=(e,t,s)=>{for(n in e)if(r=e[n],ce(r))d(n,r,t,s);else throw new TypeError(`Can't add listener because handler for "${n}" is not a function but of type ${typeof r}`)};return{on:(e,n,r)=>{if(pe(e))s=pe(n)?n:null,u(e,s,!1);else if("string"==typeof e&&ce(n))s=pe(r)?r:null,d(e,n,s,!1);else throw new TypeError(t)},once:(e,n,r)=>{if(pe(e))s=pe(n)?n:null,u(e,s,!0);else if("string"==typeof e&&ce(n))s=pe(r)?r:null,d(e,n,s,!0);else throw new TypeError(t)},off:t=>{e.delete(t)},trigger:(t,...n)=>{if(l=e.get(t)){for(let e=0;e<l.length;e++)a=l[e],a.handler.apply(a.scope,n),a.once&&o.push(a);o.length&&(e.set(t,l.filter(e=>-1===o.indexOf(e))),o.splice(0,o.length)),l=null}}}});const Ce=new Map,Ee=new Map,be={};let Se=!1,Oe=!1;const Ie=[],De=[],Ue={derivative:null,allProperties:null,derivedProperties:null},xe=-1,je=1,we=Symbol("Cue State Internals"),Te=Symbol("Instance of StateInternals"),Ne=1,ke=2,Re=new Set(["fill","push","unshift","splice","pop","shift","copyWithin","reverse","sort"]),Me=new Map([["fill",()=>t],["push",()=>n],["unshift",()=>r],["splice",()=>s],["pop",()=>i],["shift",()=>l],["copyWithin",()=>a],["reverse",()=>o],["sort",()=>d]]);class Be{constructor(e,t,n){this.sourceModule=e,this.sourceProperty=t,this.readOnly=!0===n,this.targetModule=void 0,this.targetProperty=void 0}}class ze{constructor(e,t,n){this.ownPropertyName=e,this.computation=t,this.sourceProperties=n,this.subDerivatives=[],this.superDerivatives=[],this.observers=[],this.valueCache=K(null),this.intermediate=void 0,this._value=void 0,this.stopPropagation=!1,this.needsUpdate=!1,this.hasChanged=!1}get value(){return this.needsUpdate&&(this.intermediate=this.computation.call(null,this.valueCache),c(this._value,this.intermediate)?this.hasChanged=!1:(this._value=this.intermediate,this.hasChanged=!0),this.needsUpdate=!1),this._value}updateProperty(e,t){this.valueCache[e]=t,this.needsUpdate=!0}fillCache(e){for(let t,n=0;n<this.sourceProperties.length;n++)t=this.sourceProperties[n],this.valueCache[t]=e[t];this.needsUpdate=!0}dispose(e=!0){let t;for(this.valueCache=void 0,this.observers=void 0,this.intermediate=void 0,this._value=void 0,t=0;t<this.superDerivatives.length;t++)this.superDerivatives[t].subDerivatives=this.superDerivatives[t].subDerivatives.filter(e=>e!==this),O(this.superDerivatives[t],!0);for(t=0;t<this.subDerivatives.length;t++)this.subDerivatives[t].dispose(!1);if(e)for(t=0;t<this.superDerivatives.length;t++)E(this.superDerivatives[t],xe);this.superDerivatives=void 0}}const qe={source:null,visited:[],from(e){this.source=e;const t=new Map;let n;for(n of e.keys())this._visit(n,[],t);return this.source=null,this.visited.splice(0,this.visited.length),t},_visit(e,t,n){if(this.source.has(e)){t.push(e),this.visited.push(e);const r=this.source.get(e);for(let e,s=0;s<r.sourceProperties.length;s++){if(e=r.sourceProperties[s],-1!==t.indexOf(e))throw new Error(`Circular dependency. "${r.ownPropertyName}" is required by "${e}": ${t.join(" -> ")}`);-1===this.visited.indexOf(e)&&this._visit(e,t,n)}n.has(e)||n.set(e,r)}}};class Le{constructor(e,t){this[Te]=!0,this.type=t,this.valueCache=new Map,this.module=e,this.imports=e.imports,this.mounted=!1}addChangeReaction(e,t,n,r=!0){if(!ce(t))throw new TypeError(`Property change reaction for "${e}" is not a function...`);const s=t.bind(n);if(this.observersOf.has(e)?this.observersOf.get(e).push(s):this.observersOf.set(e,[s]),this.derivedProperties.has(e)){const t=this.derivedProperties.get(e);t.observers.push(s),E(t,xe)}if(!0===r){const t=this.plainState[e];s({value:t,path:e})}return s}removeChangeReaction(e,t){if(this.observersOf.has(e)){const n=this.observersOf.get(e),r=this.derivedProperties.get(e);if(t===void 0)this.observersOf.delete(e),r&&(r.observers.splice(0,r.observers.length),E(r,je));else if(ce(t)){let s=n.indexOf(t);-1<s?n.splice(s,1):console.warn(`Can't remove the passed handler from reactions of "${e}" because it is not registered.`),r&&(s=r.observers.indexOf(t),-1<s?(r.observers.splice(s,1),E(r,je)):console.warn(`Can't remove the passed handler from observers of derived property "${e}" because it is not registered.`))}}else console.warn(`Can't unobserve property "${e}" because no reaction has been registered for it.`)}instanceDidMount(e,t){let n=e[we],r=t,s=[];for(;n&&n.type!==Ne;)n=n.rootInternals,r=n.rootPropertyName,s.unshift(r);this.rootInternals=n,this.rootPropertyName=r,this.pathFromRoot=s,this.propertyPathPrefix=0<s.length?`${s.join(".")}.`:"",this.type===Ne?(this.name=this.module.name,this.internalGetters=this.module.internalGetters,this.internalSetters=this.module.internalSetters,this.consumersOf=this.module.consumersOf,this.observersOf=new Map,this.derivativesOf=new Map,this.derivedProperties=new Map,this.providersOf=new Map,this.module.providersToInstall.size&&this.injectProviders(),this.module.derivativesToInstall.size&&this.installDerivatives(),this.module.initialize.call(this.proxyState,this.initialProps),delete this.initialProps):this.type===ke&&(this.internalGetters=de(this.plainState)?Me:Z,this.internalSetters=Z),this.mounted=!0}instanceWillUnmount(){console.log("[todo: instanceWillUnmount]",this)}injectProviders(){let e,t,n,r,s,i;for(e of this.module.providersToInstall.values())if(!1===e.readOnly){t=e.sourceModule,n=e.sourceProperty,r=e.targetModule,s=e.targetProperty;let l=this.rootInternals;for(;l&&l.type!==Ne&&l.name!==t;)l=l.rootInternals;if(l)i=l.providersOf.get(n),i=i?y(i):{sourceInternals:l,sourceProperty:n,targetModule:r,targetProperty:s},this.providersOf.set(s,i);else throw new Error(`[${r}]: Can't inject "${s}" from "${t}" because it's not an ancestor of the injecting module instance.`)}}installDerivatives(){let e,t,n,r,s,l;for(e of this.module.derivativesToInstall.values()){for(n=new ze(e.ownPropertyName,e.computation,e.sourceProperties),this.derivedProperties.set(e.ownPropertyName,n),t=0;t<e.sourceProperties.length;t++)r=e.sourceProperties[t],s=this.derivativesOf.get(r),s?s.push(n):this.derivativesOf.set(r,[n]);for(t=0;t<e.superDerivatives.length;t++)l=this.derivedProperties.get(e.superDerivatives[t].ownPropertyName),n.superDerivatives.push(l),l.subDerivatives.push(n);n.fillCache(this.proxyState)}}propertyDidChange(e,t){if(this.type===ke){const t=this.rootInternals,n=this.rootPropertyName,r=t.plainState[n],s=this.propertyPathPrefix+e,i=t.observersOf.get(n),l=t.derivativesOf.get(n);(i||l)&&(Oe?j(n,r,s,i,l,!1):x(n,r,s,i,l,!1));const a=t.consumersOf.get(n);a&&t.cueConsumers.call(t,t,a,n,r,s)}else if(this.type===Ne){const n=this.observersOf.get(e),r=this.derivativesOf.get(e);(n||r)&&(Oe?j(e,t,e,n,r,!1):x(e,t,e,n,r,!1));const s=this.consumersOf.get(e);s&&this.cueConsumers(this,s,e,t,e)}}cueConsumers(e,t,n,r){let s,i;for(s in this.plainState)if(i=this.plainState[s],i&&(i=i[we])){let s;for(s of i.providersOf.values())s.sourceInstance===e&&s.sourceProperty===n&&i.propertyDidChange.call(i,s.targetProperty,r);i.cueConsumers.call(i,e,t,n,r)}}}$(ye,{import:e=>{const t=Ce.get(e);if(!t)throw new ReferenceError(`Can't import undefined State Module "${e}".`);return t},inject:(e,t={readOnly:!1})=>{const n=e.split("."),r=n.slice(0,-1).join("."),s=n[n.length-1];if(!Ce.has(r))throw new ReferenceError(`Can't inject "${s}" from undefined State Module "${r}".`);return new Be(r,s,t.readOnly)}}),Pe.State={register:(e,t)=>{if("string"!=typeof e)throw new TypeError(`Can't create Cue State Module. First argument must be name of type string but is of type "${typeof e}".`);else if(Ce.has(e))throw new Error(`A State Module has already been registered under name "${e}". Unregister, use a unique name or consider namespacing.with.dots-or-hyphens...`);const n={name:e};Ee.set(e,n),Ce.set(e,R(n,t))},isState:e=>e&&e[we]};const Ae=new Map;$(_e,{import:e=>{const t=Ae.get(e);if(!t)throw new ReferenceError(`Can't import UI Component because nothing is registered under "${e}".`);return t}});const Ge=(()=>{const e=document.createElement("style");return e.id="CUE-STYLES",document.head.appendChild(e),e.sheet})(),We=he(()=>{const e=document,t=NodeList.prototype.isPrototypeOf,n=HTMLCollection.prototype.isPrototypeOf,r=(()=>{const n=e.createElement("tst"),r={transition:{run:"transitionrun",start:"transitionstart",end:"transitionend"},WebkitTransition:{run:"webkitTransitionRun",start:"webkitTransitionStart",end:"webkitTransitionEnd"},MozTransition:{run:"transitionRun",start:"transitionStart",end:"transitionEnd"},MSTransition:{run:"msTransitionRun",start:"msTransitionStart",end:"msTransitionEnd"},OTransition:{run:"oTransitionRun",start:"oTransitionStart",end:"oTransitionEnd"}};for(const e in r)if(n.style[e])return r[e]})();return class{constructor(e,t,n,r){this.element=e,this.imports=t,this.styles=n,this.keyframes=r,this.reactions=new Map,this.events=new Map,this.autorun=!0}select(r,i){if("string"==typeof r){i=i?this.select(i):this.element;let t,n;switch(r[0]){case"#":t=e.getElementById(r.substring(1));break;case".":t=i.getElementsByClassName(this.styles.get(n=r.substring(1))||n);break;default:t=i.querySelectorAll(r);}return t.nodeType!==Node.TEXT_NODE&&t.length?1===t.length?t[0]:ue(t):t}if(r instanceof Element)return r;if(Qe.UI.isComponent(r))return r.element;if(t(r)||n(r))return ue(r);if(de(r))return r.map(e=>this.select(e,i));if(pe(r)){const e={};for(const t in r)e[t]=this.select(r[t],i);return e}}hasContent(e){return e=e?this.select(e):this.element,!!(e.children.length||e.textContent.trim().length)}isIterable(e){return e=e?this.select(e):this.element,e.nodeType!==Node.TEXT_NODE&&e.length}hasClass(e,t){return 1===arguments.length?(t=e,e=this.element):e=this.select(e),e.classList.contains(this.styles.get(t)||t)}addClass(e,t){let n;return 1===arguments.length?(n=e.split(" ").map(e=>this.styles.get(e)||e),e=this.element):(e=this.select(e),n=t.split(" ").map(e=>this.styles.get(e)||e)),e.classList.add(...n),this}removeClass(e,t){let n;return 1===arguments.length?(n=e.split(" ").map(e=>this.styles.get(e)||e),e=this.element):(e=this.select(e),n=t.split(" ").map(e=>this.styles.get(e)||e)),e.classList.remove(...n),this}toggleClass(e,t){return 1===arguments.length?(t=e,e=this.element):e=this.select(e),e.classList.toggle(this.styles.get(t)||t),this}replaceClass(e,t,n){return 2===arguments.length?(t=e,n=t,e=this.element):e=this.select(e),e.classList.replace(this.styles.get(t)||t,this.styles.get(n)||n),this}index(e){return e=e?this.select(e):this.element,ue(e.parentNode.children).indexOf(e)}siblings(e,t){return 1===arguments.length?(t=!0===e,e=this.element):e=this.select(e),t?ue(e.parentNode.children):ue(e.parentNode.children).filter(t=>t!==e)}refs(e){e=e?this.select(e):this.element;const t=e.querySelectorAll("[ref]");if(t.length){const e={};for(let n,r=0;r<t.length;r++)n=t[r],e[n.getAttribute("ref")]=n;return e}}boundingBox(e){e=e?this.select(e):this.element;const t=e.cloneNode(!0);t.style.position="absolute",t.style.left="-100000px",t.style.top="-100000px",t.style.display="block",this.element.parentElement.appendChild(t);const n=t.getBoundingClientRect();return t.parentElement.removeChild(t),n}position(e){return e=e?this.select(e):this.element,{top:e.offsetTop,left:e.offsetLeft}}offset(e){e=e?this.select(e):this.element;const t=e.getBoundingClientRect();return{top:t.top+document.body.scrollTop,left:t.left+document.body.scrollLeft}}awaitTransition(...e){return e=e.length?e.map(e=>this.select(e)):[this.element],Promise.all(e.map(e=>r.end?new Promise(t=>{const n=this.select(e),s=()=>{n.removeEventListener(r.end,s),t()};n.addEventListener(r.end,s)}):Promise.resolve()))}setChildren(e,{from:r=[],to:t,create:n,update:s=le}){if(e=1===arguments.length?this.element:this.select(e),0===t.length)return e.textContent="",this;if(0===r.length){for(let r=0;r<t.length;r++)e.appendChild(n(t[r]));return this}return L(e,r,t,n,s),this}insertBefore(e,t){return 1===arguments.length?(t=this.select(e),e=this.element):(e=this.select(e),t=this.select(t)),t.parentNode.insertBefore(e,t),this}insertAfter(e,t){return 1===arguments.length?(t=this.select(e),e=this.element):(e=this.select(e),t=this.select(t)),t.parentNode.insertBefore(e,t.nextSibling),this}insertAt(e,t){1===arguments.length?(t=parseInt(e),e=this.element):(e=this.select(e),t=parseInt(t));const n=e.parentNode,r=n.children;return t>=r.length?n.appendChild(e):0>=t?n.insertBefore(e,n.firstChild):n.insertBefore(e,r[t>=Array.from(r).indexOf(e)?t+1:t]),this}detach(e){return e=e?this.select(e):this.element,e.parentNode.removeChild(e)}remove(e){return e=e?this.select(e):this.element,e.parentNode.removeChild(e),this}}});Pe.UI={register:(e,t)=>{if("string"!=typeof e)throw new TypeError(`Can't create Cue-UI Module. First argument must be name of type string but is of type "${typeof e}".`);else if(!t||"function"!=typeof t&&!ge(t))throw new TypeError(`Can't create Cue-UI Module. Second argument must be module initializer function or configuration object but is of type "${typeof t}".`);else if(Ae.has(e))throw new Error(`A UI Module has already been registered under name "${e}". Unregister, use a unique name or consider namespacing.with.dots-or-hyphens...`);const n=Y(t);return Ae.set(e,n),n},isComponent:e=>e instanceof We};const Fe=new Map,Xe={core:me,state:ye,ui:_e},Ye=e=>"string"==typeof e&&2<e.length&&-1!==e.indexOf("-"),Ve=e=>e.split("-"),Je=(e,t)=>e.didInstall?e.extensionPoint:(e.extensionPoint=e.installer.call(null,Xe,t),e.didInstall=!0,e.extensionPoint);Pe.Plugin={register:(e,t,n)=>{if(!Ye(e))throw new Error(`Plugin must be defined with a namespaced-name (vendor-plugin) of type string as the first argument.`);const[r,s]=Ve(e);if(!t&&!n){const t=Fe.get(r);if(t){const n=t.get(s);if(n)return n;throw new Error(`No Plugin with name ${e} has been registered under "${r}".`)}else throw new Error(`No Plugin has been registered under "${t}".`)}else{if("function"!=typeof t)throw new Error(`Plugin must be defined with an installable function as the second argument.`);const i=Fe.get(r)||Fe.set(r,new Map).get(r);if(i.has(s))return console.warn(`A plugin with name "${s}" has already been registered under "${r}". Skipping installation...`),i.get(s).name;const l={installer:t,didInstall:!1,name:e,extensionPoint:void 0};return i.set(s,l),n&&Je(l),e}},use:(e,t)=>{if(!Ye(e))throw new Error(`pluginName must be a namespaced-string (vendor-plugin).`);const[n,r]=Ve(e),s=Fe.get(n);if(s){const e=s.get(r);if(e)return Je(e,t)}throw new Error(`No Plugin has been registered under "${e}".`)}};class He{constructor(e){if(!pe(e))throw new TypeError("Cue config must be an object.");this.stateModule=e.state,this.stateInstance=null,this.stateInternals=null,this.uiComponent=e.ui,this.uiElement=null,this.mounted=!1}mount(e,t=void 0){if(!0===this.mounted)throw new Error("Cue instance already mounted.");let n;"string"==typeof this.stateModule?n=this.stateModule:("function"==typeof this.stateModule||"object"==typeof this.stateModule)&&(n=fe("cue_module"),Pe.State.register(n,this.stateModule));let r;"string"==typeof this.uiComponent?r=this.uiComponent:("function"==typeof this.uiComponent||"object"==typeof this.uiComponent)&&(r=fe("cue_component"),Pe.UI.register(r,this.uiComponent));const s=ye.import(n),i=_e.import(r);if(e="string"==typeof e?document.querySelector(e):e instanceof Element?e:void 0,!e)throw new TypeError(`Target must be a valid DOM Element or DOM Selector String.`);const l=this.stateInstance=s(t),a=this.stateInternals=l[we];a.instanceDidMount.call(a,be,n);const o=this.uiElement=i(l);return e.appendChild(o),this.mounted=!0,this}unmount(){if(!1===this.mounted)throw new Error(`Can't unmount Cue instance because it has not been mounted.`);return this.uiElement.parentElement.removeChild(this.uiElement),this.uiElement=null,this.stateInstance=null,this.stateInternals=null,this.mounted=!1,this}getState(e){if(!this.stateInstance)throw new ReferenceError(`State can't be "${typeof this.stateInstance}" when getting it. Mount the Cue Instance first.`);else return this.stateInternals.proxyState.get(e)}setState(e){if(!this.stateInstance)throw new ReferenceError(`State can't be "${typeof this.stateInstance}" when setting it. Mount the Cue Instance first.`);else this.stateInternals.proxyState.set(e);return this}}const Qe=e.Cue=e=>new He(e);Object.defineProperties(Qe,{on:{value:Pe.EventBus.on},once:{value:Pe.EventBus.once},off:{value:Pe.EventBus.off},trigger:{value:Pe.EventBus.trigger},Plugin:{value:Pe.Plugin.register},usePlugin:{value:Pe.Plugin.use},State:{value:Pe.State.register},isState:{value:Pe.State.isState},UI:{value:Pe.UI.register},isComponent:{value:Pe.UI.isComponent}}),Qe.Plugin("cue-math",e=>{const t=Math,n=t.max,r=t.min,s=t.random,i=t.abs,l=t.pow,a=t.round,o=t.floor,u=t.ceil,p=t.PI;return e.core.Math={clamp(e,t,s){return n(e,r(t,s))},lerp(e,t,n){return(1-n)*e+n*t},smoothStep(e,t,n){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))},translate(e,t,n,r,s){return n+(s-e)*(r-n)/(t-e)},createTranslator(e,t,n,r){return 0===e&&0<n?e=>e*(r-n)/t+n:0===n&&0<e?n=>(n-e)*r/(t-e):0===e===n?e=>e*r/r:this.translate},convertBits(e,t,n){return 32>e?32>t?n*l(2,t)/l(2,e):n/l(2,e):32>t?a(n*l(2,t)):n},randomIntBetween(e,t){return o(s()*(t-e+1)+e)},randomFloatBetween(e,t){return s()*(t-e)+e},isOdd(e){return 1&e},isEven(e){return!(1&e)},degreesToRadians(e){return e*(p/180)},radiansToDegrees(e){return e*(180/p)},scale(e,t){const n=e.length-1,r=t-1;let s,l=0,p=0,g=0,h=0;for(s=1;s<r;s++)l=s*(n/r),p=o(l),g=u(l),h=l-p,e[s]=e[p]+(e[g]-e[p])*h;return e[r]=e[n],this},closest(e,t){return e.reduce((e,n)=>i(n-t)<i(e-t)?n:e)},smallest(e){let t=1/0;for(let n=0;n<e.length;n++)e[n]<t&&(t=e[n]);return t===1/0?void 0:t},largest(e){let t=-Infinity;for(let n=0;n<e.length;n++)e[n]>t&&(t=e[n]);return t===-Infinity?void 0:t}}},!0),Qe.Plugin("cue-string",e=>e.core.String={createUID(){let e=0;return(this.createUID=function(){let t,r="";for(const n=e.toString(26).split("");t=n.shift();)r+="abcdefghijklmnopqrstuvwxyz"[parseInt(t,26)];return e++,r}).call(this)},toCamelCase(e){const t=document.createElement("div");return t.setAttribute(`data-${e}`,""),oe(t.dataset)[0]},toDashedCase(e){const t=document.createElement("div");return t.dataset[e]="",t.attributes[0].name.substr(5)}},!0),Qe.Plugin("cue-array",e=>{const t=Array.isArray;return e.core.Array={flatten(e){return e.reduce((e,n)=>e.concat(t(n)?this.flatten(n):n),[])},insertEveryNth(e,t,r){for(let n=e.length;0<--n;)0==n%r&&e.splice(n,0,t);return this},removeEveryNth(e,t){for(let n=e.length;--n;)0==n%t&&e.splice(n,1);return this},removeRange(e,t,n){return e.splice(t,n-t),this},merge(e,...t){let n,r,l;for(n=0;n<t.length;n++)for(l=t[n],r=0;r<l.length;r++)e.push(l[r]);return this}}},!0),Qe.Plugin("cue-equality",e=>{const t=Object,n=Array.isArray;return t.assign(e.core,{isEqual(e,r,s=!1){if(e===r)return!0;if(e&&r&&"object"==typeof e&&"object"==typeof r){const i=e.constructor===t,l=r.constructor===t;if(i!==l)return!1;if(i&&l)return this.arePlainObjectsEqual(e,r,s);const a=n(e),o=n(r);if(a!==o)return!1;if(a&&o)return this.areArraysEqual(e,r,s);const d=e instanceof Map,u=r instanceof Map;if(d!==u)return!1;if(d&&u)return this.areMapsEqual(e,r,s);const p=e instanceof Set,g=r instanceof Set;if(p!==g)return!1;if(p&&g)return this.areSetsEqual(e,r,s);const c=e instanceof Date,h=r instanceof Date;if(c!==h)return!1;if(c&&h)return e.getTime()===r.getTime();const v=e instanceof RegExp,f=r instanceof RegExp;return v===f&&(v&&f?e.toString()===r.toString():this.arePlainObjectsEqual(e,r,s))}return e!==e&&r!==r},areArraysEqual(e,t,n=!1){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!this.isEqual(e[r],t[r],n))return!1;return!0},arePlainObjectsEqual(e,t,n=!1){const r=oe(e),s=oe(t);if(r.length!==s.length)return!1;for(let l,a=0;a<r.length;a++)if(l=r[a],-1===s.indexOf(l)||!this.isEqual(e[l],t[s[a]],n))return!1;return!0},areMapsEqual(e,t,n=!1){if(e.size!==t.size)return!1;const r=Array.from(e),s=Array.from(t);for(let l,a,o=0;o<r.length;o++)if(l=r[o],a=s[o],l[0]!==a[0]||!this.isEqual(l[1],a[1],n))return!1;return!0},areSetsEqual(e,t,n=!1){if(e.size!==t.size)return!1;const r=Array.from(e),s=Array.from(t);for(let l=0;l<r.length;l++)if(!this.isEqual(r[l],s[l],n))return!1;return!0}})},!0),Qe.Plugin("cue-clone",e=>{const t=Object,n=t.prototype.toString,r=e=>"object"==typeof e&&null!==e,s=Array.isArray,i=Object.getPrototypeOf;return t.assign(e.core,{clone(e,t=!1){if(s(e))return this.cloneArray(e,t);if(r(e)){if(n.call(e)==="[object Object]"||null===i(e))return this.clonePlainObject(e,t);if(e instanceof Map)return this.cloneMap(e,t);if(e instanceof Set)return this.cloneSet(e,t);if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return RegExp(e.source,e.flags)}throw new TypeError(`Can't clone non-object, null or undefined."`)},cloneArray(e,t=!1){if(t){const n=[];for(let s,l=0;l<e.length;l++)s=e[l],n.push(r(s)?this.clone(s,t):s);return n}return e.slice()},clonePlainObject(e,n=!1){if(n){const t={};let s,i;for(s in e)i=e[s],t[s]=r(i)?this.clone(i,n):i;return t}return t.assign({},e)},cloneMap(e,t=!1){const n=new Map;return t?e.forEach((e,s)=>n.set(r(s)?this.clone(s,t):s,r(e)?this.clone(e,t):e)):e.forEach((e,t)=>n.set(t,e)),n},cloneSet(e,t=!1){const n=new Set;return e.forEach(e=>n.add(t&&r(e)?this.clone(e,t):e)),n}})},!0),Qe.Plugin("cue-fn",e=>e.core.Function={throttle(e,t=250,n=null){let r=0,s=0;return function(...i){r=Date.now(),r>s+t&&(e.apply(n,i),s=r)}},defer(e,t=250,n=null){let r=null;return function(...s){clearTimeout(r),r=setTimeout(()=>{e.apply(n,s),r=null},t)}},createTaskWorker(e){const t="function"==typeof e?e:e.process?e.process:void 0,n=new Worker(window.URL.createObjectURL(new Blob([`(function() { onmessage = ${t.toString()} })()`],{type:"application/javascript"})));return e.response&&(n.onmessage=e.response),e.onError&&(n.onerror=e.onError),{process:n.postMessage.bind(n),terminate:n.terminate.bind(n),set response(e){n.onmessage=e},get response(){return n.onmessage},set onError(e){n.onerror=e},get onError(){return n.onerror}}}},!0)})(window||this);